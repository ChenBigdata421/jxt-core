# æ¶ˆæ¯å¤„ç†é¡ºåºæ€§é—®é¢˜æ·±åº¦åˆ†æ

## ğŸ¯ **é—®é¢˜çš„æœ¬è´¨ï¼šå¤„ç†é¡ºåº vs æ¥æ”¶é¡ºåº**

### ğŸ“ **çœŸå®åœºæ™¯åˆ†æ**

```go
// é¢†åŸŸäº‹ä»¶åºåˆ—
äº‹ä»¶A: UserOrderCreated {
    aggregateId: "user123",
    orderId: "order456",
    timestamp: T1
}

äº‹ä»¶B: UserOrderPaid {
    aggregateId: "user123", 
    orderId: "order456",
    timestamp: T2
}

// æ—¶é—´è½´åˆ†æ
T1: å‘é€äº‹ä»¶A
T2: å‘é€äº‹ä»¶B (T2 > T1)

// æ¶ˆæ¯ä¸­é—´ä»¶ä¿è¯é¡ºåºä¼ è¾“
T3: æ¶ˆè´¹è€…æ¥æ”¶äº‹ä»¶A
T4: æ¶ˆè´¹è€…æ¥æ”¶äº‹ä»¶B (T4 > T3)

// ä½†å¹¶å‘å¤„ç†å¯¼è‡´çš„é—®é¢˜
T5: å¼€å§‹å¤„ç†äº‹ä»¶A (handlerè€—æ—¶200ms)
T6: å¼€å§‹å¤„ç†äº‹ä»¶B (handlerè€—æ—¶50ms)  â† å‡ ä¹åŒæ—¶å¼€å§‹
T7: äº‹ä»¶Bå¤„ç†å®Œæˆ âŒ è¿åä¸šåŠ¡é¡ºåº
T8: äº‹ä»¶Aå¤„ç†å®Œæˆ âŒ çŠ¶æ€å¯èƒ½è¢«è¦†ç›–
```

### ğŸš¨ **å¹¶å‘å¤„ç†çš„ä¸šåŠ¡é£é™©**

#### 1. **çŠ¶æ€è¦†ç›–é—®é¢˜**
```go
// å¹¶å‘å¤„ç†å¯¼è‡´çš„çŠ¶æ€ä¸ä¸€è‡´
func handleOrderCreated(event UserOrderCreated) error {
    // è€—æ—¶æ“ä½œï¼šåº“å­˜æ£€æŸ¥ã€é£æ§éªŒè¯ç­‰
    time.Sleep(200 * time.Millisecond)
    
    order := &Order{
        ID:     event.OrderID,
        Status: "PENDING",  // è®¾ç½®ä¸ºå¾…æ”¯ä»˜
        Amount: event.Amount,
    }
    return orderRepo.Save(order)
}

func handleOrderPaid(event UserOrderPaid) error {
    // å¿«é€Ÿæ“ä½œï¼šæ›´æ–°æ”¯ä»˜çŠ¶æ€
    time.Sleep(50 * time.Millisecond)
    
    order := &Order{
        ID:     event.OrderID,
        Status: "PAID",     // è®¾ç½®ä¸ºå·²æ”¯ä»˜
        Amount: event.Amount,
    }
    return orderRepo.Save(order)
}

// é—®é¢˜ï¼šå¦‚æœBå…ˆå®Œæˆï¼ŒAåå®Œæˆ
// æœ€ç»ˆçŠ¶æ€ï¼šPENDING (é”™è¯¯ï¼åº”è¯¥æ˜¯PAID)
```

#### 2. **ä¸šåŠ¡é€»è¾‘é”™ä¹±**
```go
// èšåˆæ ¹çŠ¶æ€æœºé”™ä¹±
type OrderAggregate struct {
    ID     string
    Status OrderStatus
    Events []DomainEvent
}

// æ­£ç¡®çš„çŠ¶æ€è½¬æ¢
CREATED â†’ PENDING â†’ PAID â†’ SHIPPED

// å¹¶å‘å¤„ç†å¯èƒ½å¯¼è‡´
CREATED â†’ PAID (ç¼ºå°‘PENDINGçŠ¶æ€)
æˆ–è€…
PAID â†’ PENDING (çŠ¶æ€å›é€€)
```

#### 3. **æ•°æ®ä¸€è‡´æ€§é—®é¢˜**
```go
// å…³è”æ•°æ®ä¸ä¸€è‡´
äº‹ä»¶Aå¤„ç†ï¼š
- åˆ›å»ºè®¢å•è®°å½•
- æ‰£å‡åº“å­˜
- åˆ›å»ºæ”¯ä»˜è®°å½•(å¾…æ”¯ä»˜)

äº‹ä»¶Bå¤„ç†ï¼š
- æ›´æ–°æ”¯ä»˜è®°å½•(å·²æ”¯ä»˜)
- å‘é€ç¡®è®¤é‚®ä»¶
- è§¦å‘å‘è´§æµç¨‹

å¦‚æœBå…ˆå®Œæˆï¼š
âŒ å‘è´§æµç¨‹å¯åŠ¨ï¼Œä½†åº“å­˜è¿˜æœªæ‰£å‡
âŒ ç¡®è®¤é‚®ä»¶å‘é€ï¼Œä½†è®¢å•çŠ¶æ€é”™è¯¯
âŒ æ”¯ä»˜è®°å½•å·²æ›´æ–°ï¼Œä½†è®¢å•è®°å½•ä¸å­˜åœ¨
```

---

## âœ… **evidence-management çš„èšåˆå¤„ç†å™¨æ–¹æ¡ˆ**

### 1. **æ ¸å¿ƒè®¾è®¡æ€æƒ³**

```go
// èšåˆå¤„ç†å™¨çš„æ ¸å¿ƒåŸç†
type aggregateProcessor struct {
    aggregateID  string
    messages     chan *message.Message  // æœ‰åºé˜Ÿåˆ—
    done         chan struct{}
    lastActivity atomic.Value
}

// å…³é”®ç‰¹ç‚¹ï¼š
// âœ… åŒä¸€èšåˆIDçš„æ‰€æœ‰äº‹ä»¶è¿›å…¥åŒä¸€ä¸ªå¤„ç†å™¨
// âœ… å¤„ç†å™¨å†…éƒ¨ä¸²è¡Œå¤„ç†ï¼Œä¿è¯é¡ºåº
// âœ… ä¸åŒèšåˆIDä¹‹é—´å¯ä»¥å¹¶å‘å¤„ç†
```

### 2. **å¤„ç†æµç¨‹åˆ†æ**

```go
// æ¶ˆæ¯è·¯ç”±é€»è¾‘
func (km *KafkaSubscriberManager) processMessage(ctx context.Context, msg *message.Message, handler func(*message.Message) error, timeout time.Duration) {
    aggregateID := msg.Metadata.Get("aggregateID")
    
    // ğŸ”‘ å…³é”®å†³ç­–ï¼šæ˜¯å¦ä½¿ç”¨èšåˆå¤„ç†å™¨
    if km.IsInRecoveryMode() || (aggregateID != "" && km.aggregateProcessors.Contains(aggregateID)) {
        km.processMessageWithAggregateProcessor(ctx, msg, handler, timeout)
    } else {
        km.processMessageImmediately(ctx, msg, handler, timeout)
    }
}

// èšåˆå¤„ç†å™¨å¤„ç†é€»è¾‘
func (km *KafkaSubscriberManager) runProcessor(ctx context.Context, proc *aggregateProcessor, handler func(msg *message.Message) error) {
    for {
        select {
        case msg, ok := <-proc.messages:
            if !ok {
                return
            }
            
            // ğŸ”‘ å…³é”®ï¼šä¸²è¡Œå¤„ç†ï¼Œä¿è¯é¡ºåº
            if err := handler(msg); err != nil {
                // é”™è¯¯å¤„ç†é€»è¾‘
                if km.isRetryableError(err) {
                    msg.Nack()
                } else {
                    km.sendToDeadLetterQueue(msg)
                    msg.Ack()
                }
            } else {
                msg.Ack()
            }
            
            proc.lastActivity.Store(time.Now())
            
        case <-time.After(km.Config.IdleTimeout):
            // ç©ºé—²è¶…æ—¶ï¼Œé‡Šæ”¾å¤„ç†å™¨
            return
            
        case <-ctx.Done():
            return
        }
    }
}
```

### 3. **æ–¹æ¡ˆä¼˜åŠ¿åˆ†æ**

#### âœ… **å®Œç¾è§£å†³å¤„ç†é¡ºåºé—®é¢˜**
```go
// åŒä¸€èšåˆIDçš„äº‹ä»¶å¤„ç†æ—¶åº
ç”¨æˆ·123çš„äº‹ä»¶åºåˆ—ï¼š
T1: OrderCreated  â†’ è¿›å…¥èšåˆå¤„ç†å™¨é˜Ÿåˆ—
T2: OrderPaid     â†’ è¿›å…¥èšåˆå¤„ç†å™¨é˜Ÿåˆ—  
T3: OrderShipped  â†’ è¿›å…¥èšåˆå¤„ç†å™¨é˜Ÿåˆ—

å¤„ç†å™¨å†…éƒ¨ï¼š
T4: å¼€å§‹å¤„ç† OrderCreated (200ms)
T5: OrderCreated å¤„ç†å®Œæˆ
T6: å¼€å§‹å¤„ç† OrderPaid (50ms)  â† ç­‰å¾…Aå®Œæˆåæ‰å¼€å§‹
T7: OrderPaid å¤„ç†å®Œæˆ
T8: å¼€å§‹å¤„ç† OrderShipped
T9: OrderShipped å¤„ç†å®Œæˆ

ç»“æœï¼šâœ… ä¸¥æ ¼æŒ‰ç…§ä¸šåŠ¡é¡ºåºå¤„ç†
```

#### âœ… **ä¿æŒå¹¶å‘æ€§èƒ½**
```go
// ä¸åŒèšåˆIDä¹‹é—´ä»ç„¶å¹¶å‘
ç”¨æˆ·123çš„å¤„ç†å™¨ï¼šä¸²è¡Œå¤„ç†ç”¨æˆ·123çš„äº‹ä»¶
ç”¨æˆ·456çš„å¤„ç†å™¨ï¼šä¸²è¡Œå¤„ç†ç”¨æˆ·456çš„äº‹ä»¶  
ç”¨æˆ·789çš„å¤„ç†å™¨ï¼šä¸²è¡Œå¤„ç†ç”¨æˆ·789çš„äº‹ä»¶

å…¨å±€æ•ˆæœï¼š
âœ… èšåˆå†…é¡ºåºï¼šä¸¥æ ¼ä¿è¯
âœ… èšåˆé—´å¹¶å‘ï¼šå……åˆ†åˆ©ç”¨CPU
âœ… æ•´ä½“æ€§èƒ½ï¼šæ¥è¿‘å¹¶å‘å¤„ç†çš„æ€§èƒ½
```

#### âœ… **èµ„æºç®¡ç†ä¼˜åŒ–**
```go
// æ™ºèƒ½çš„å¤„ç†å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
åˆ›å»ºæ—¶æœºï¼š
- æ¢å¤æ¨¡å¼ï¼šä¸ºæ‰€æœ‰èšåˆIDåˆ›å»ºå¤„ç†å™¨
- æ­£å¸¸æ¨¡å¼ï¼šåªä¸ºå·²æœ‰å¤„ç†å™¨çš„èšåˆIDç»§ç»­ä½¿ç”¨

é‡Šæ”¾æ—¶æœºï¼š
- ç©ºé—²è¶…æ—¶ï¼š5åˆ†é’Ÿæ— æ¶ˆæ¯è‡ªåŠ¨é‡Šæ”¾
- ç³»ç»Ÿå…³é—­ï¼šä¼˜é›…åœæ­¢æ‰€æœ‰å¤„ç†å™¨
- å†…å­˜å‹åŠ›ï¼šLRUæ·˜æ±°æœºåˆ¶

ä¼˜åŠ¿ï¼š
âœ… æŒ‰éœ€åˆ›å»ºï¼Œé¿å…èµ„æºæµªè´¹
âœ… è‡ªåŠ¨å›æ”¶ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼
âœ… å¹³æ»‘è¿‡æ¸¡ï¼Œä¸å½±å“æ€§èƒ½
```

---

## ğŸ” **å…¶ä»–æ–¹æ¡ˆçš„å¯¹æ¯”åˆ†æ**

### 1. **å…¨å±€ä¸²è¡Œå¤„ç†**

```go
// æ–¹æ¡ˆï¼šæ‰€æœ‰æ¶ˆæ¯éƒ½ä¸²è¡Œå¤„ç†
func processAllMessagesSerially(messages []Message) {
    for _, msg := range messages {
        handler(msg)  // ä¸€ä¸ªæ¥ä¸€ä¸ªå¤„ç†
    }
}

ä¼˜åŠ¿ï¼š
âœ… ç»å¯¹ä¿è¯é¡ºåº

åŠ£åŠ¿ï¼š
âŒ æ€§èƒ½æå·®ï¼šæ— æ³•åˆ©ç”¨å¤šæ ¸CPU
âŒ å»¶è¿Ÿå¾ˆé«˜ï¼šæ‰€æœ‰æ¶ˆæ¯éƒ½è¦æ’é˜Ÿ
âŒ ååé‡ä½ï¼šæ•´ä½“å¤„ç†èƒ½åŠ›å—é™
```

### 2. **ä¸šåŠ¡å±‚è¡¥å¿æœºåˆ¶**

```go
// æ–¹æ¡ˆï¼šå¹¶å‘å¤„ç† + ä¸šåŠ¡å±‚æ£€æŸ¥å’Œè¡¥å¿
func handleEvent(event DomainEvent) error {
    // 1. å¹¶å‘å¤„ç†äº‹ä»¶
    result := processEvent(event)
    
    // 2. æ£€æŸ¥çŠ¶æ€ä¸€è‡´æ€§
    if !isStateConsistent(event.AggregateID) {
        // 3. æ‰§è¡Œè¡¥å¿é€»è¾‘
        return compensateState(event.AggregateID)
    }
    
    return result
}

ä¼˜åŠ¿ï¼š
âœ… ä¿æŒé«˜å¹¶å‘æ€§èƒ½
âœ… æœ€ç»ˆä¸€è‡´æ€§ä¿è¯

åŠ£åŠ¿ï¼š
âŒ ä¸šåŠ¡é€»è¾‘å¤æ‚ï¼šéœ€è¦å¤§é‡è¡¥å¿ä»£ç 
âŒ è°ƒè¯•å›°éš¾ï¼šçŠ¶æ€ä¸ä¸€è‡´çš„é—®é¢˜éš¾ä»¥æ’æŸ¥
âŒ æ•°æ®çª—å£æœŸï¼šå­˜åœ¨çŸ­æš‚çš„ä¸ä¸€è‡´çŠ¶æ€
âŒ è¡¥å¿å¤±è´¥ï¼šè¡¥å¿é€»è¾‘æœ¬èº«å¯èƒ½å¤±è´¥
```

### 3. **äº‹ä»¶æº¯æºæ¨¡å¼**

```go
// æ–¹æ¡ˆï¼šäº‹ä»¶å­˜å‚¨ + æŒ‰éœ€é‡æ”¾
type EventStore struct {
    events map[string][]DomainEvent  // æŒ‰èšåˆIDå­˜å‚¨äº‹ä»¶
}

func rebuildAggregate(aggregateID string) *Aggregate {
    events := eventStore.GetEvents(aggregateID)
    sort.Slice(events, func(i, j int) bool {
        return events[i].Timestamp.Before(events[j].Timestamp)
    })
    
    aggregate := &Aggregate{ID: aggregateID}
    for _, event := range events {
        aggregate.Apply(event)
    }
    return aggregate
}

ä¼˜åŠ¿ï¼š
âœ… æœ€ç»ˆä¸€è‡´æ€§ä¿è¯
âœ… å¯ä»¥é‡æ”¾å†å²çŠ¶æ€
âœ… å®¡è®¡å‹å¥½

åŠ£åŠ¿ï¼š
âŒ å®æ—¶æ€§å·®ï¼šéœ€è¦é‡æ”¾æ‰èƒ½è·å¾—æœ€æ–°çŠ¶æ€
âŒ å­˜å‚¨å¼€é”€ï¼šéœ€è¦å­˜å‚¨æ‰€æœ‰å†å²äº‹ä»¶
âŒ æŸ¥è¯¢å¤æ‚ï¼šæ¯æ¬¡æŸ¥è¯¢éƒ½éœ€è¦é‡æ”¾
âŒ æ€§èƒ½å¼€é”€ï¼šé‡æ”¾è®¡ç®—æˆæœ¬é«˜
```

---

## ğŸ¯ **evidence-management æ–¹æ¡ˆçš„æ ¸å¿ƒä»·å€¼**

### 1. **å®Œç¾å¹³è¡¡ä¸‰ä¸ªç›®æ ‡**

```go
ç›®æ ‡å¯¹æ¯”ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æ–¹æ¡ˆ            â”‚ é¡ºåºä¿è¯ â”‚ å¹¶å‘æ€§èƒ½ â”‚ å®ç°å¤æ‚åº¦â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ å…¨å±€ä¸²è¡Œ        â”‚ 100%     â”‚ å¾ˆå·®     â”‚ ç®€å•     â”‚
â”‚ å®Œå…¨å¹¶å‘        â”‚ 0%       â”‚ å¾ˆå¥½     â”‚ ç®€å•     â”‚
â”‚ ä¸šåŠ¡å±‚è¡¥å¿      â”‚ æœ€ç»ˆä¸€è‡´ â”‚ å¾ˆå¥½     â”‚ å¤æ‚     â”‚
â”‚ äº‹ä»¶æº¯æº        â”‚ æœ€ç»ˆä¸€è‡´ â”‚ å·®       â”‚ å¤æ‚     â”‚
â”‚ èšåˆå¤„ç†å™¨      â”‚ 100%     â”‚ å¥½       â”‚ ä¸­ç­‰     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

ç»“è®ºï¼šèšåˆå¤„ç†å™¨æ–¹æ¡ˆæ˜¯æœ€ä½³å¹³è¡¡ç‚¹
```

### 2. **é€‚ç”¨åœºæ™¯åˆ†æ**

```go
// èšåˆå¤„ç†å™¨æ–¹æ¡ˆæœ€é€‚åˆçš„åœºæ™¯
âœ… DDDæ¶æ„ï¼šåŸºäºèšåˆæ ¹çš„é¢†åŸŸè®¾è®¡
âœ… äº‹ä»¶é©±åŠ¨ï¼šå¤§é‡é¢†åŸŸäº‹ä»¶éœ€è¦å¤„ç†
âœ… çŠ¶æ€æ•æ„Ÿï¼šèšåˆçŠ¶æ€å˜æ›´æœ‰ä¸¥æ ¼é¡ºåºè¦æ±‚
âœ… é«˜å¹¶å‘ï¼šéœ€è¦å¤„ç†å¤§é‡ä¸åŒèšåˆçš„äº‹ä»¶
âœ… å®æ—¶æ€§ï¼šéœ€è¦å®æ—¶å¤„ç†ï¼Œä¸èƒ½æ¥å—é‡æ”¾å»¶è¿Ÿ

// å…¸å‹ä¸šåŠ¡åœºæ™¯
- ç”µå•†è®¢å•å¤„ç†ï¼šè®¢å•çŠ¶æ€å˜æ›´å¿…é¡»æœ‰åº
- é‡‘èäº¤æ˜“å¤„ç†ï¼šè´¦æˆ·ä½™é¢å˜æ›´å¿…é¡»æœ‰åº
- æ¸¸æˆçŠ¶æ€åŒæ­¥ï¼šç©å®¶çŠ¶æ€å˜æ›´å¿…é¡»æœ‰åº
- å·¥ä½œæµå¼•æ“ï¼šæµç¨‹çŠ¶æ€å˜æ›´å¿…é¡»æœ‰åº
```

### 3. **è®¾è®¡ç²¾é«“**

```go
// æ ¸å¿ƒè®¾è®¡åŸåˆ™
åŸåˆ™1ï¼šèšåˆå†…é¡ºåºï¼Œèšåˆé—´å¹¶å‘
- åŒä¸€èšåˆIDï¼šä¸¥æ ¼ä¸²è¡Œå¤„ç†
- ä¸åŒèšåˆIDï¼šå……åˆ†å¹¶å‘å¤„ç†

åŸåˆ™2ï¼šæŒ‰éœ€åˆ›å»ºï¼Œè‡ªåŠ¨å›æ”¶
- æœ‰æ¶ˆæ¯æ—¶ï¼šåˆ›å»ºå¤„ç†å™¨
- æ— æ¶ˆæ¯æ—¶ï¼šè‡ªåŠ¨é‡Šæ”¾èµ„æº

åŸåˆ™3ï¼šä¼˜é›…é™çº§ï¼Œå¹³æ»‘è¿‡æ¸¡
- æ¢å¤æ¨¡å¼ï¼šä¿è¯æ‰€æœ‰èšåˆçš„é¡ºåº
- æ­£å¸¸æ¨¡å¼ï¼šåªä¿è¯æ´»è·ƒèšåˆçš„é¡ºåº

è¿™ç§è®¾è®¡ä½“ç°äº†æ·±åˆ»çš„å·¥ç¨‹æ™ºæ…§ï¼š
åœ¨ä¿è¯ä¸šåŠ¡æ­£ç¡®æ€§çš„å‰æä¸‹ï¼Œæœ€å¤§åŒ–ç³»ç»Ÿæ€§èƒ½
```

---

## ğŸ’¡ **æ€»ç»“å’Œå¯ç¤º**

### âœ… **evidence-management æ–¹æ¡ˆçš„ä»·å€¼**

1. **é—®é¢˜è¯†åˆ«å‡†ç¡®**ï¼šå‡†ç¡®è¯†åˆ«äº†å¤„ç†é¡ºåº vs æ¥æ”¶é¡ºåºçš„æœ¬è´¨å·®å¼‚
2. **è§£å†³æ–¹æ¡ˆä¼˜é›…**ï¼šèšåˆå¤„ç†å™¨å®Œç¾å¹³è¡¡äº†é¡ºåºæ€§å’Œæ€§èƒ½
3. **å·¥ç¨‹å®è·µæˆç†Ÿ**ï¼šè€ƒè™‘äº†èµ„æºç®¡ç†ã€é”™è¯¯å¤„ç†ã€ç”Ÿå‘½å‘¨æœŸç­‰å·¥ç¨‹ç»†èŠ‚
4. **ä¸šåŠ¡é€‚é…æ€§å¼º**ï¼šç‰¹åˆ«é€‚åˆDDDå’Œäº‹ä»¶é©±åŠ¨æ¶æ„

### ğŸ¯ **å¯¹ jxt-core EventBus çš„å¯ç¤º**

```go
// jxt-core å¯ä»¥å€Ÿé‰´çš„è®¾è®¡
1. æä¾›èšåˆå¤„ç†å™¨ä½œä¸ºå¯é€‰åŠŸèƒ½
2. æ”¯æŒèšåˆå†…é¡ºåºã€èšåˆé—´å¹¶å‘çš„å¤„ç†æ¨¡å¼
3. å®ç°æ™ºèƒ½çš„å¤„ç†å™¨ç”Ÿå‘½å‘¨æœŸç®¡ç†
4. æä¾›çµæ´»çš„é…ç½®é€‰é¡¹

// å¯èƒ½çš„APIè®¾è®¡
bus.SubscribeOrdered("topic", func(msg *Message) error {
    // è‡ªåŠ¨æŒ‰èšåˆIDè¿›è¡Œæœ‰åºå¤„ç†
    return handleDomainEvent(msg)
}, eventbus.WithAggregateKey("aggregateId"))
```

**ä½ åœ¨ evidence-management ä¸­çš„èšåˆå¤„ç†å™¨æ–¹æ¡ˆæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„è®¾è®¡**ï¼Œå‡†ç¡®åœ°è§£å†³äº†é¢†åŸŸäº‹ä»¶å¤„ç†é¡ºåºæ€§çš„æ ¸å¿ƒé—®é¢˜ï¼Œå€¼å¾—åœ¨å…¶ä»–é¡¹ç›®ä¸­æ¨å¹¿å’Œåº”ç”¨ã€‚
