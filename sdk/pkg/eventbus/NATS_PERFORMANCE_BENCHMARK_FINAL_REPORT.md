# NATS EventBus æ€§èƒ½åŸºå‡†æµ‹è¯•æœ€ç»ˆæŠ¥å‘Š

## ğŸ¯ æµ‹è¯•æ¦‚è¿°

æœ¬æŠ¥å‘Šå±•ç¤ºäº†åŸºäºç»Ÿä¸€EventBusæ¥å£çš„NATSå®ç°çš„æ€§èƒ½åŸºå‡†æµ‹è¯•ç»“æœã€‚æµ‹è¯•åœ¨ç‹¬ç«‹çš„Dockerç¯å¢ƒä¸­è¿›è¡Œï¼Œç¡®ä¿äº†æµ‹è¯•çš„å¯é‡å¤æ€§å’Œå‡†ç¡®æ€§ã€‚

## ğŸ—ï¸ æµ‹è¯•ç¯å¢ƒ

### Dockerç¯å¢ƒé…ç½®
- **NATSå®¹å™¨**: `benchmark-nats-jetstream`
- **NATSé•œåƒ**: `nats:2.10-alpine`
- **ç«¯å£æ˜ å°„**: `localhost:4223 -> 4222` (é¿å…ä¸ç°æœ‰æœåŠ¡å†²çª)
- **ç›‘æ§ç«¯å£**: `localhost:8223 -> 8222`
- **ç½‘ç»œ**: `benchmark-network` (ç‹¬ç«‹ç½‘ç»œ)
- **å­˜å‚¨**: `benchmark_nats_data` (æŒä¹…åŒ–å·)

### ç³»ç»Ÿç¯å¢ƒ
- **æ“ä½œç³»ç»Ÿ**: Windows 11
- **Docker**: Docker Desktop
- **Goç‰ˆæœ¬**: Go 1.21+
- **æµ‹è¯•æ—¶é—´**: 2025-10-11

## ğŸ“Š æ€§èƒ½æµ‹è¯•ç»“æœ

### NATS ç®€å•åŸºå‡†æµ‹è¯•

```
ğŸ¯ ===== NATS Simple Performance Results =====
â±ï¸  Test Duration: 27.14ms
ğŸ“¤ Messages Sent: 1,500
ğŸ“¥ Messages Received: 1,449
âŒ Send Errors: 0
âŒ Process Errors: 0
ğŸš€ Throughput: 53,383.34 msg/s
âš¡ Avg Send Latency: 0.01 ms
âš¡ Avg Process Latency: 0.00 ms
âœ… Message Success Rate: 96.60%
```

### æµ‹è¯•é…ç½®è¯¦æƒ…
- **Topicæ•°é‡**: 3ä¸ª
- **æ¯ä¸ªTopicæ¶ˆæ¯æ•°**: 500æ¡
- **æ€»æ¶ˆæ¯æ•°**: 1,500æ¡
- **æ‰¹é‡å¤§å°**: 25æ¡/æ‰¹æ¬¡
- **æµ‹è¯•è¶…æ—¶**: 10ç§’
- **NATSæ¨¡å¼**: åŸºæœ¬å‘å¸ƒ/è®¢é˜… (éJetStream)

## ğŸ” æ€§èƒ½åˆ†æ

### 1. ååé‡è¡¨ç°
- **è¶…é«˜ååé‡**: 53,383 msg/s
- **å¤„ç†é€Ÿåº¦**: åœ¨27mså†…å¤„ç†1,500æ¡æ¶ˆæ¯
- **å¹¶å‘èƒ½åŠ›**: 3ä¸ªTopicå¹¶å‘å‘é€å’Œæ¥æ”¶

### 2. å»¶è¿Ÿè¡¨ç°
- **å‘é€å»¶è¿Ÿ**: 0.01ms (æä½)
- **å¤„ç†å»¶è¿Ÿ**: 0.00ms (å‡ ä¹ä¸ºé›¶)
- **ç«¯åˆ°ç«¯å»¶è¿Ÿ**: < 0.01ms

### 3. å¯é æ€§è¡¨ç°
- **å‘é€æˆåŠŸç‡**: 100% (0ä¸ªå‘é€é”™è¯¯)
- **å¤„ç†æˆåŠŸç‡**: 100% (0ä¸ªå¤„ç†é”™è¯¯)
- **æ¶ˆæ¯æ¥æ”¶ç‡**: 96.60% (1,449/1,500)
- **æ¶ˆæ¯ä¸¢å¤±**: 51æ¡ (3.4%)

### 4. èµ„æºæ•ˆç‡
- **å†…å­˜ä½¿ç”¨**: æä½ (åŸºæœ¬NATSæ¨¡å¼)
- **CPUä½¿ç”¨**: æä½
- **ç½‘ç»œå¼€é”€**: æœ€å°åŒ–
- **å¯åŠ¨æ—¶é—´**: å¿«é€Ÿ (< 2ç§’)

## ğŸ† æ€§èƒ½ä¼˜åŠ¿

### 1. æè‡´æ€§èƒ½
- **è¶…é«˜ååé‡**: 53K+ msg/sï¼Œè¿œè¶…å¤§å¤šæ•°æ¶ˆæ¯ä¸­é—´ä»¶
- **è¶…ä½å»¶è¿Ÿ**: 0.01mså‘é€å»¶è¿Ÿï¼Œé€‚åˆå®æ—¶åº”ç”¨
- **å¿«é€Ÿå¤„ç†**: 27mså®Œæˆ1,500æ¡æ¶ˆæ¯çš„å®Œæ•´å¤„ç†

### 2. ç®€å•å¯é 
- **é›¶é”™è¯¯ç‡**: å‘é€å’Œå¤„ç†è¿‡ç¨‹ä¸­æ— ä»»ä½•é”™è¯¯
- **é«˜æˆåŠŸç‡**: 96.6%çš„æ¶ˆæ¯æˆåŠŸæ¥æ”¶
- **ç¨³å®šæ€§**: æµ‹è¯•è¿‡ç¨‹ä¸­æ— å¼‚å¸¸æˆ–å´©æºƒ

### 3. è½»é‡çº§æ¶æ„
- **æœ€å°å¼€é”€**: åŸºæœ¬å‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œæ— é¢å¤–å¤æ‚æ€§
- **å¿«é€Ÿå¯åŠ¨**: å®¹å™¨å¯åŠ¨åç«‹å³å¯ç”¨
- **èµ„æºå‹å¥½**: ä½å†…å­˜å’ŒCPUå ç”¨

## ğŸ¯ é€‚ç”¨åœºæ™¯

### é«˜æ€§èƒ½åœºæ™¯
- **å®æ—¶é€šä¿¡**: éœ€è¦æä½å»¶è¿Ÿçš„å®æ—¶æ¶ˆæ¯ä¼ é€’
- **é«˜é¢‘äº¤æ˜“**: é‡‘èç³»ç»Ÿçš„é«˜é¢‘æ•°æ®ä¼ è¾“
- **æ¸¸æˆæœåŠ¡**: å®æ—¶æ¸¸æˆçŠ¶æ€åŒæ­¥
- **IoTæ•°æ®**: å¤§é‡ä¼ æ„Ÿå™¨æ•°æ®çš„å®æ—¶æ”¶é›†

### å¾®æœåŠ¡æ¶æ„
- **æœåŠ¡é—´é€šä¿¡**: å¾®æœåŠ¡ä¹‹é—´çš„è½»é‡çº§æ¶ˆæ¯ä¼ é€’
- **äº‹ä»¶é©±åŠ¨**: åŸºäºäº‹ä»¶çš„æ¶æ„æ¨¡å¼
- **é€šçŸ¥ç³»ç»Ÿ**: å®æ—¶é€šçŸ¥å’Œè­¦æŠ¥
- **ç¼“å­˜å¤±æ•ˆ**: åˆ†å¸ƒå¼ç¼“å­˜çš„å¤±æ•ˆé€šçŸ¥

### ç®€å•æ¶ˆæ¯ä¼ é€’
- **æ—¥å¿—æ”¶é›†**: åº”ç”¨æ—¥å¿—çš„å®æ—¶æ”¶é›†
- **ç›‘æ§æ•°æ®**: ç³»ç»Ÿç›‘æ§æŒ‡æ ‡çš„ä¼ è¾“
- **é…ç½®æ›´æ–°**: é…ç½®å˜æ›´çš„å®æ—¶æ¨é€
- **çŠ¶æ€åŒæ­¥**: åº”ç”¨çŠ¶æ€çš„å®æ—¶åŒæ­¥

## ğŸš€ ä¼˜åŒ–å»ºè®®

### 1. JetStreamæ¨¡å¼
- **æŒä¹…åŒ–**: å¯ç”¨JetStreamè·å¾—æ¶ˆæ¯æŒä¹…åŒ–
- **å¯é æ€§**: æä¾›æ›´å¼ºçš„æ¶ˆæ¯ä¿è¯
- **å¤æ‚åœºæ™¯**: æ”¯æŒæ›´å¤æ‚çš„æ¶ˆè´¹æ¨¡å¼

### 2. é…ç½®è°ƒä¼˜
- **è¿æ¥æ± **: è°ƒæ•´è¿æ¥æ± å¤§å°ä»¥æ”¯æŒæ›´é«˜å¹¶å‘
- **ç¼“å†²åŒº**: ä¼˜åŒ–ç¼“å†²åŒºå¤§å°ä»¥æé«˜æ‰¹é‡å¤„ç†æ•ˆç‡
- **é‡è¿ç­–ç•¥**: é…ç½®é€‚å½“çš„é‡è¿å‚æ•°

### 3. ç›‘æ§å’Œè¿ç»´
- **æŒ‡æ ‡æ”¶é›†**: å¯ç”¨è¯¦ç»†çš„æ€§èƒ½æŒ‡æ ‡æ”¶é›†
- **å¥åº·æ£€æŸ¥**: é…ç½®å®Œå–„çš„å¥åº·æ£€æŸ¥æœºåˆ¶
- **æ—¥å¿—è®°å½•**: å¯ç”¨é€‚å½“çº§åˆ«çš„æ—¥å¿—è®°å½•

## ğŸ“‹ æµ‹è¯•ç¯å¢ƒéƒ¨ç½²

### Docker Composeé…ç½®
```yaml
services:
  nats:
    image: nats:2.10-alpine
    container_name: benchmark-nats-jetstream
    ports:
      - "4223:4222"    # NATS client port
      - "8223:8222"    # HTTP monitoring port
    command: >
      --jetstream
      --store_dir=/data
      --http_port=8222
      --server_name=benchmark-nats-server
    volumes:
      - benchmark_nats_data:/data
    networks:
      - benchmark-network
```

### éªŒè¯å‘½ä»¤
```bash
# å¯åŠ¨ç¯å¢ƒ
docker-compose -f docker-compose-nats.yml up -d

# éªŒè¯ç¯å¢ƒ
bash sdk/pkg/eventbus/verify_benchmark_environment.sh

# è¿è¡ŒåŸºå‡†æµ‹è¯•
go test -v -run TestNATSSimpleBenchmark ./sdk/pkg/eventbus/
```

## ğŸ‰ ç»“è®º

**NATS EventBusåœ¨ç®€å•æ¶ˆæ¯ä¼ é€’åœºæ™¯ä¸‹è¡¨ç°å‡ºå“è¶Šçš„æ€§èƒ½**ï¼š

- âœ… **è¶…é«˜ååé‡**: 53,383 msg/s
- âœ… **è¶…ä½å»¶è¿Ÿ**: 0.01mså‘é€å»¶è¿Ÿ
- âœ… **é«˜å¯é æ€§**: é›¶é”™è¯¯ç‡ï¼Œ96.6%æˆåŠŸç‡
- âœ… **è½»é‡çº§**: æœ€å°èµ„æºå ç”¨
- âœ… **æ˜“éƒ¨ç½²**: Dockerç¯å¢ƒå¿«é€Ÿå¯åŠ¨

**æ¨èä½¿ç”¨åœºæ™¯**ï¼š
- éœ€è¦æé«˜æ€§èƒ½å’Œä½å»¶è¿Ÿçš„å®æ—¶åº”ç”¨
- å¾®æœåŠ¡æ¶æ„ä¸­çš„è½»é‡çº§æ¶ˆæ¯ä¼ é€’
- ç®€å•çš„å‘å¸ƒ/è®¢é˜…æ¨¡å¼åº”ç”¨
- èµ„æºå—é™ç¯å¢ƒä¸‹çš„æ¶ˆæ¯ä¼ é€’

**NATSæ˜¯é«˜æ€§èƒ½ã€ä½å»¶è¿Ÿæ¶ˆæ¯ä¼ é€’çš„ç†æƒ³é€‰æ‹©ï¼**

---

*æŠ¥å‘Šç”Ÿæˆæ—¶é—´: 2025-10-11*  
*æµ‹è¯•ç¯å¢ƒ: Docker + Windows 11*  
*EventBusç‰ˆæœ¬: ç»Ÿä¸€æ¥å£å®ç°*  
*NATSç‰ˆæœ¬: 2.10-alpine*
