=== RUN   TestE2E_MemoryEventBus_WithEnvelope
--- PASS: TestE2E_MemoryEventBus_WithEnvelope (1.21s)
=== RUN   TestE2E_MemoryEventBus_MultipleTopics
--- PASS: TestE2E_MemoryEventBus_MultipleTopics (0.60s)
=== RUN   TestE2E_MemoryEventBus_ConcurrentPublishSubscribe
--- PASS: TestE2E_MemoryEventBus_ConcurrentPublishSubscribe (2.10s)
=== RUN   TestE2E_MemoryEventBus_ErrorRecovery
--- PASS: TestE2E_MemoryEventBus_ErrorRecovery (0.60s)
=== RUN   TestE2E_MemoryEventBus_ContextCancellation
--- PASS: TestE2E_MemoryEventBus_ContextCancellation (0.30s)
=== RUN   TestE2E_MemoryEventBus_Metrics
--- PASS: TestE2E_MemoryEventBus_Metrics (0.60s)
=== RUN   TestMarshalToString
--- PASS: TestMarshalToString (0.00s)
=== RUN   TestUnmarshalFromString
--- PASS: TestUnmarshalFromString (0.00s)
=== RUN   TestMarshal
--- PASS: TestMarshal (0.00s)
=== RUN   TestUnmarshal
--- PASS: TestUnmarshal (0.00s)
=== RUN   TestMarshalFast
--- PASS: TestMarshalFast (0.00s)
=== RUN   TestUnmarshalFast
--- PASS: TestUnmarshalFast (0.00s)
=== RUN   TestJSON_RoundTrip
--- PASS: TestJSON_RoundTrip (0.00s)
=== RUN   TestJSONFast_RoundTrip
--- PASS: TestJSONFast_RoundTrip (0.00s)
=== RUN   TestMarshalToString_Error
--- PASS: TestMarshalToString_Error (0.00s)
=== RUN   TestUnmarshalFromString_Error
--- PASS: TestUnmarshalFromString_Error (0.00s)
=== RUN   TestMarshal_Struct
--- PASS: TestMarshal_Struct (0.00s)
=== RUN   TestUnmarshal_Struct
--- PASS: TestUnmarshal_Struct (0.00s)
=== RUN   TestJSON_Variables
--- PASS: TestJSON_Variables (0.00s)
=== RUN   TestRawMessage
--- PASS: TestRawMessage (0.00s)
=== RUN   TestMarshalToString_EmptyObject
--- PASS: TestMarshalToString_EmptyObject (0.00s)
=== RUN   TestUnmarshalFromString_EmptyObject
--- PASS: TestUnmarshalFromString_EmptyObject (0.00s)
=== RUN   TestMarshal_Array
--- PASS: TestMarshal_Array (0.00s)
=== RUN   TestUnmarshal_Array
--- PASS: TestUnmarshal_Array (0.00s)
=== RUN   TestKafkaBasicPublishSubscribe
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.basic.1760445119615
    kafka_nats_test.go:38: ğŸ“¨ Received message: Hello Kafka!
    kafka_nats_test.go:56: âœ… Kafka basic publish/subscribe test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.basic.1760445119615
--- PASS: TestKafkaBasicPublishSubscribe (10.41s)
=== RUN   TestNATSBasicPublishSubscribe
    kafka_nats_test.go:78: ğŸ“¨ Received message: Hello NATS!
    kafka_nats_test.go:96: âœ… NATS basic publish/subscribe test passed
--- PASS: TestNATSBasicPublishSubscribe (3.11s)
=== RUN   TestKafkaMultipleMessages
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.multiple.1760445133139
    kafka_nats_test.go:137: âœ… Kafka multiple messages test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.multiple.1760445133139
--- PASS: TestKafkaMultipleMessages (10.50s)
=== RUN   TestNATSMultipleMessages
    kafka_nats_test.go:178: âœ… NATS multiple messages test passed
--- PASS: TestNATSMultipleMessages (3.11s)
=== RUN   TestKafkaPublishWithOptions
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.options.1760445146752
    kafka_nats_test.go:222: âœ… Kafka PublishWithOptions test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.options.1760445146752
--- PASS: TestKafkaPublishWithOptions (10.40s)
=== RUN   TestNATSPublishWithOptions
    kafka_nats_test.go:265: âœ… NATS PublishWithOptions test passed
--- PASS: TestNATSPublishWithOptions (3.11s)
=== RUN   TestKafkaEnvelopePublishSubscribe
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.envelope.1760445160260
    kafka_nats_test.go:291: ğŸ“¨ Received envelope: AggregateID=test-aggregate-1, EventType=TestEvent, Version=1
    kafka_nats_test.go:319: âœ… Kafka Envelope publish/subscribe test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.envelope.1760445160260
--- PASS: TestKafkaEnvelopePublishSubscribe (10.51s)
=== RUN   TestNATSEnvelopePublishSubscribe
    kafka_nats_test.go:342: ğŸ“¨ Received envelope: AggregateID=test-aggregate-1, EventType=TestEvent, Version=1
    kafka_nats_test.go:370: âœ… NATS Envelope publish/subscribe test passed
--- PASS: TestNATSEnvelopePublishSubscribe (4.12s)
=== RUN   TestKafkaEnvelopeOrdering
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.envelope.order.1760445174884
    kafka_nats_test.go:435: âœ… Kafka Envelope ordering test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.envelope.order.1760445174884
--- PASS: TestKafkaEnvelopeOrdering (10.41s)
=== RUN   TestNATSEnvelopeOrdering
    kafka_nats_test.go:501: âœ… NATS Envelope ordering test passed
--- PASS: TestNATSEnvelopeOrdering (4.12s)
=== RUN   TestKafkaMultipleAggregates
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.multi.agg.1760445189413
    kafka_nats_test.go:551: âœ… Kafka multiple aggregates test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.multi.agg.1760445189413
--- PASS: TestKafkaMultipleAggregates (10.52s)
=== RUN   TestKafkaClose
    test_helper.go:299: Close should not return error: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    kafka_nats_test.go:575: âœ… Kafka Close test passed
--- FAIL: TestKafkaClose (0.01s)
=== RUN   TestNATSClose
    kafka_nats_test.go:596: âœ… NATS Close test passed
--- PASS: TestNATSClose (0.00s)
=== RUN   TestKafkaPublishCallback
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.pub.callback.1760445199951
    kafka_nats_test.go:614: ğŸ“ Publish callback called: Topic=test.kafka.pub.callback.1760445199951, Error=<nil>
    kafka_nats_test.go:628: âœ… Kafka RegisterPublishCallback test passed (callback called: true)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.pub.callback.1760445199951
--- PASS: TestKafkaPublishCallback (7.23s)
=== RUN   TestKafkaTopicConfiguration
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.topic.config.1760445207180
    kafka_nats_test.go:675: âœ… Kafka topic configuration test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.topic.config.1760445207180
--- PASS: TestKafkaTopicConfiguration (5.24s)
=== RUN   TestNATSTopicConfiguration
    kafka_nats_test.go:719: âœ… NATS topic configuration test passed
--- PASS: TestNATSTopicConfiguration (2.06s)
=== RUN   TestKafkaSetTopicPersistence
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.persistence.1760445214474
    kafka_nats_test.go:744: âœ… Kafka SetTopicPersistence test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.persistence.1760445214474
--- PASS: TestKafkaSetTopicPersistence (5.23s)
=== RUN   TestNATSSetTopicPersistence
    kafka_nats_test.go:770: âœ… NATS SetTopicPersistence test passed
--- PASS: TestNATSSetTopicPersistence (2.02s)
=== RUN   TestKafkaRemoveTopicConfig
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.remove.config.1760445221724
    kafka_nats_test.go:808: âœ… Kafka RemoveTopicConfig test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.remove.config.1760445221724
--- PASS: TestKafkaRemoveTopicConfig (5.24s)
=== RUN   TestNATSRemoveTopicConfig
    kafka_nats_test.go:847: âœ… NATS RemoveTopicConfig test passed
--- PASS: TestNATSRemoveTopicConfig (2.02s)
=== RUN   TestKafkaStartupTopicConfiguration
    test_helper.go:330: âœ… Created Kafka topic: business.orders.1760445228984
    test_helper.go:330: âœ… Created Kafka topic: system.notifications.1760445228984
    test_helper.go:330: âœ… Created Kafka topic: audit.logs.1760445228984
    kafka_nats_test.go:903: âœ… Configured topic: business.orders.1760445228984
    kafka_nats_test.go:903: âœ… Configured topic: system.notifications.1760445228984
    kafka_nats_test.go:903: âœ… Configured topic: audit.logs.1760445228984
    kafka_nats_test.go:920: âœ… Kafka startup topic configuration test passed (configured 3 topics)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: business.orders.1760445228984
    test_helper.go:213: âœ… Deleted Kafka topic: system.notifications.1760445228984
    test_helper.go:213: âœ… Deleted Kafka topic: audit.logs.1760445228984
--- PASS: TestKafkaStartupTopicConfiguration (5.66s)
=== RUN   TestKafkaIdempotentTopicConfiguration
    test_helper.go:330: âœ… Created Kafka topic: test.kafka.idempotent.1760445234643
    kafka_nats_test.go:962: âœ… Kafka idempotent topic configuration test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:213: âœ… Deleted Kafka topic: test.kafka.idempotent.1760445234643
--- PASS: TestKafkaIdempotentTopicConfiguration (5.23s)
=== RUN   TestNATSStartupTopicConfiguration
    kafka_nats_test.go:996: âœ… Configured topic: business.orders.1760445239877 (mode: persistent)
    kafka_nats_test.go:996: âœ… Configured topic: system.notifications.1760445239877 (mode: ephemeral)
    kafka_nats_test.go:1003: âœ… NATS startup topic configuration test passed (configured 2 topics)
--- PASS: TestNATSStartupTopicConfiguration (1.01s)
=== RUN   TestKafkaTopicConfigStrategy
    kafka_nats_test.go:1026: âœ… Kafka topic config strategy test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaTopicConfigStrategy (1.01s)
=== RUN   TestNATSTopicConfigStrategy
    kafka_nats_test.go:1050: âœ… NATS topic config strategy test passed
--- PASS: TestNATSTopicConfigStrategy (1.00s)
=== RUN   TestKafkaSubscriberBacklogMonitoring
    monitoring_test.go:48: âœ… Kafka subscriber backlog monitoring test passed (callback called: false)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaSubscriberBacklogMonitoring (4.01s)
=== RUN   TestNATSSubscriberBacklogMonitoring
    monitoring_test.go:83: âœ… NATS subscriber backlog monitoring test passed (callback called: false)
--- PASS: TestNATSSubscriberBacklogMonitoring (4.01s)
=== RUN   TestKafkaPublisherBacklogMonitoring
    monitoring_test.go:117: âœ… Kafka publisher backlog monitoring test passed (callback called: false)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaPublisherBacklogMonitoring (4.01s)
=== RUN   TestNATSPublisherBacklogMonitoring
    monitoring_test.go:152: âœ… NATS publisher backlog monitoring test passed (callback called: false)
--- PASS: TestNATSPublisherBacklogMonitoring (4.01s)
=== RUN   TestKafkaStartAllBacklogMonitoring
    monitoring_test.go:193: âœ… Kafka StartAllBacklogMonitoring test passed (sub: false, pub: false)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaStartAllBacklogMonitoring (4.01s)
=== RUN   TestNATSStartAllBacklogMonitoring
    monitoring_test.go:236: âœ… NATS StartAllBacklogMonitoring test passed (sub: false, pub: false)
--- PASS: TestNATSStartAllBacklogMonitoring (4.01s)
=== RUN   TestKafkaSetMessageRouter
    monitoring_test.go:255: âœ… Kafka SetMessageRouter test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaSetMessageRouter (1.01s)
=== RUN   TestNATSSetMessageRouter
    monitoring_test.go:274: âœ… NATS SetMessageRouter test passed
--- PASS: TestNATSSetMessageRouter (1.01s)
=== RUN   TestKafkaSetErrorHandler
    monitoring_test.go:302: âœ… Kafka SetErrorHandler test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaSetErrorHandler (1.01s)
=== RUN   TestKafkaHealthCheckPublisher
    monitoring_test.go:337: ğŸ“Š Health check publisher status: {IsHealthy:true ConsecutiveFailures:0 LastSuccessTime:2025-10-14 20:34:29.9975646 +0800 CST m=+155.809372601 LastFailureTime:0001-01-01 00:00:00 +0000 UTC IsRunning:true EventBusType:kafka Source:kafka-eventbus}
    monitoring_test.go:343: âœ… Kafka health check publisher test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaHealthCheckPublisher (4.01s)
=== RUN   TestNATSHealthCheckPublisher
    monitoring_test.go:366: ğŸ“Š Health check publisher status: {IsHealthy:true ConsecutiveFailures:0 LastSuccessTime:2025-10-14 20:34:34.0084216 +0800 CST m=+159.820229601 LastFailureTime:0001-01-01 00:00:00 +0000 UTC IsRunning:true EventBusType:nats Source:nats-eventbus}
    monitoring_test.go:372: âœ… NATS health check publisher test passed
--- PASS: TestNATSHealthCheckPublisher (4.01s)
=== RUN   TestKafkaHealthCheckSubscriber
    monitoring_test.go:394: ğŸ“Š Health check subscriber stats: {StartTime:2025-10-14 20:34:38.0185007 +0800 CST m=+163.830308701 LastMessageTime:2025-10-14 20:34:38.2434313 +0800 CST m=+164.055239301 TotalMessagesReceived:1 ConsecutiveMisses:0 TotalAlerts:0 LastAlertTime:0001-01-01 00:00:00 +0000 UTC IsHealthy:true UptimeSeconds:6.0010398}
    monitoring_test.go:400: âœ… Kafka health check subscriber test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaHealthCheckSubscriber (7.04s)
=== RUN   TestNATSHealthCheckSubscriber
    monitoring_test.go:423: ğŸ“Š Health check subscriber stats: {StartTime:2025-10-14 20:34:45.0570645 +0800 CST m=+170.868872501 LastMessageTime:0001-01-01 00:00:00 +0000 UTC TotalMessagesReceived:0 ConsecutiveMisses:0 TotalAlerts:0 LastAlertTime:0001-01-01 00:00:00 +0000 UTC IsHealthy:false UptimeSeconds:3.0001973}
    monitoring_test.go:429: âœ… NATS health check subscriber test passed
--- PASS: TestNATSHealthCheckSubscriber (4.01s)
=== RUN   TestKafkaStartAllHealthCheck
    monitoring_test.go:452: ğŸ“Š Publisher status: {IsHealthy:true ConsecutiveFailures:0 LastSuccessTime:2025-10-14 20:34:49.0657015 +0800 CST m=+174.877509501 LastFailureTime:0001-01-01 00:00:00 +0000 UTC IsRunning:true EventBusType:kafka Source:kafka-eventbus}
    monitoring_test.go:453: ğŸ“Š Subscriber stats: {StartTime:2025-10-14 20:34:49.0657015 +0800 CST m=+174.877509501 LastMessageTime:2025-10-14 20:34:49.2820109 +0800 CST m=+175.093818901 TotalMessagesReceived:2 ConsecutiveMisses:0 TotalAlerts:0 LastAlertTime:0001-01-01 00:00:00 +0000 UTC IsHealthy:true UptimeSeconds:6.000536}
    monitoring_test.go:459: âœ… Kafka StartAllHealthCheck test passed
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaStartAllHealthCheck (7.02s)
=== RUN   TestNATSStartAllHealthCheck
    monitoring_test.go:483: ğŸ“Š Publisher status: {IsHealthy:true ConsecutiveFailures:0 LastSuccessTime:2025-10-14 20:34:56.0935598 +0800 CST m=+181.905367801 LastFailureTime:0001-01-01 00:00:00 +0000 UTC IsRunning:true EventBusType:nats Source:nats-eventbus}
    monitoring_test.go:484: ğŸ“Š Subscriber stats: {StartTime:2025-10-14 20:34:56.0935598 +0800 CST m=+181.905367801 LastMessageTime:2025-10-14 20:34:56.1368451 +0800 CST m=+181.948653101 TotalMessagesReceived:1 ConsecutiveMisses:0 TotalAlerts:0 LastAlertTime:0001-01-01 00:00:00 +0000 UTC IsHealthy:true UptimeSeconds:3.0006066}
    monitoring_test.go:490: âœ… NATS StartAllHealthCheck test passed
--- PASS: TestNATSStartAllHealthCheck (4.01s)
=== RUN   TestKafkaHealthCheckPublisherCallback
    monitoring_test.go:511: ğŸ“ Health check publisher callback called: {Success:true Timestamp:2025-10-14 20:35:00.1025945 +0800 CST m=+185.914402501 Duration:0s Error:<nil> ConsecutiveFailures:0 EventBusType:kafka Source:kafka-eventbus}
    monitoring_test.go:523: âœ… Kafka health check publisher callback test passed (callback called: true)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaHealthCheckPublisherCallback (4.01s)
=== RUN   TestNATSHealthCheckPublisherCallback
    monitoring_test.go:545: ğŸ“ Health check publisher callback called: {Success:true Timestamp:2025-10-14 20:35:04.1120614 +0800 CST m=+189.923869401 Duration:0s Error:<nil> ConsecutiveFailures:0 EventBusType:nats Source:nats-eventbus}
    monitoring_test.go:557: âœ… NATS health check publisher callback test passed (callback called: true)
--- PASS: TestNATSHealthCheckPublisherCallback (4.01s)
=== RUN   TestKafkaHealthCheckSubscriberCallback
    monitoring_test.go:590: âœ… Kafka health check subscriber callback test passed (callback called: false)
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaHealthCheckSubscriberCallback (10.10s)
=== RUN   TestKafkaHealthCheckPublisherSubscriberIntegration
    monitoring_test.go:637: ğŸš€ A ç«¯ï¼šå¯åŠ¨å¥åº·æ£€æŸ¥å‘å¸ƒå™¨ï¼ˆé—´éš”ï¼š10ç§’ï¼‰
    monitoring_test.go:642: ğŸš€ B ç«¯ï¼šå¯åŠ¨å¥åº·æ£€æŸ¥è®¢é˜…å™¨
    monitoring_test.go:648: â³ ç­‰å¾…å¥åº·æ£€æŸ¥æ¶ˆæ¯å‘é€å’Œæ¥æ”¶ï¼ˆ1åˆ†é’Ÿï¼‰...
    monitoring_test.go:649: âœ… EventBus ç°åœ¨ä½¿ç”¨è‡ªå®šä¹‰å¥åº·æ£€æŸ¥é…ç½®ï¼ˆé—´éš”ï¼š10ç§’ï¼‰
    monitoring_test.go:654: ğŸ“Š A ç«¯å‘å¸ƒå™¨çŠ¶æ€: IsHealthy=true, ConsecutiveFailures=0, LastSuccessTime=2025-10-14 20:36:18.2275639 +0800 CST m=+264.039371901
    monitoring_test.go:676: ğŸ“Š B ç«¯è®¢é˜…å™¨ç»Ÿè®¡: TotalMessagesReceived=10, ConsecutiveMisses=0, IsHealthy=true, LastMessageTime=2025-10-14 20:36:18.276466 +0800 CST m=+264.088274001
    monitoring_test.go:697: âš ï¸  B ç«¯è®¢é˜…å™¨åœ¨ 1 åˆ†é’Ÿå†…æ¥æ”¶åˆ° 10 æ¡æ¶ˆæ¯ï¼Œè¶…è¿‡é¢„æœŸçš„ 8 æ¡
    monitoring_test.go:708: ğŸ›‘ åœæ­¢ A ç«¯å¥åº·æ£€æŸ¥å‘å¸ƒå™¨
    monitoring_test.go:713: ğŸ›‘ åœæ­¢ B ç«¯å¥åº·æ£€æŸ¥è®¢é˜…å™¨
    monitoring_test.go:717: âœ… Kafka å¥åº·æ£€æŸ¥å‘å¸ƒç«¯å’Œè®¢é˜…ç«¯é›†æˆæµ‹è¯•é€šè¿‡
    monitoring_test.go:718:    - A ç«¯æˆåŠŸå‘é€å¥åº·æ£€æŸ¥æ¶ˆæ¯ï¼ˆè‡ªå®šä¹‰é—´éš”ï¼š10ç§’ï¼‰
    monitoring_test.go:719:    - B ç«¯æˆåŠŸæ¥æ”¶ 10 æ¡å¥åº·æ£€æŸ¥æ¶ˆæ¯ï¼ˆæµ‹è¯•æ—¶é•¿ï¼š1åˆ†é’Ÿï¼‰
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
    test_helper.go:369: âš ï¸  Failed to close EventBus: errors during kafka eventbus close: [failed to close kafka client: kafka: tried to use a client that was closed]
--- PASS: TestKafkaHealthCheckPublisherSubscriberIntegration (65.06s)
=== RUN   TestNATSHealthCheckPublisherSubscriberIntegration
    monitoring_test.go:765: ğŸš€ B ç«¯ï¼šå…ˆå¯åŠ¨å¥åº·æ£€æŸ¥è®¢é˜…å™¨ï¼ˆNATS Core éœ€è¦å…ˆè®¢é˜…ï¼‰
    monitoring_test.go:773: ğŸš€ A ç«¯ï¼šå†å¯åŠ¨å¥åº·æ£€æŸ¥å‘å¸ƒå™¨
    monitoring_test.go:779: â³ ç­‰å¾…å¥åº·æ£€æŸ¥æ¶ˆæ¯å‘é€å’Œæ¥æ”¶ï¼ˆ1åˆ†é’Ÿï¼‰...
    monitoring_test.go:780: âœ… EventBus ç°åœ¨ä½¿ç”¨è‡ªå®šä¹‰å¥åº·æ£€æŸ¥é…ç½®ï¼ˆé—´éš”ï¼š10ç§’ï¼‰
    monitoring_test.go:785: ğŸ“Š A ç«¯å‘å¸ƒå™¨çŠ¶æ€: IsHealthy=true, ConsecutiveFailures=0, LastSuccessTime=2025-10-14 20:37:14.2952739 +0800 CST m=+320.107081901
    monitoring_test.go:807: ğŸ“Š B ç«¯è®¢é˜…å™¨ç»Ÿè®¡: TotalMessagesReceived=6, ConsecutiveMisses=0, IsHealthy=true, LastMessageTime=2025-10-14 20:37:14.2971897 +0800 CST m=+320.108997701
    monitoring_test.go:830: âœ… B ç«¯è®¢é˜…å™¨åœ¨ 1 åˆ†é’Ÿå†…æ¥æ”¶åˆ° 6 æ¡æ¶ˆæ¯ï¼Œç¬¦åˆé¢„æœŸï¼ˆ5-8 æ¡ï¼‰
    monitoring_test.go:839: ğŸ›‘ åœæ­¢ A ç«¯å¥åº·æ£€æŸ¥å‘å¸ƒå™¨
    monitoring_test.go:844: ğŸ›‘ åœæ­¢ B ç«¯å¥åº·æ£€æŸ¥è®¢é˜…å™¨
    monitoring_test.go:848: âœ… NATS å¥åº·æ£€æŸ¥å‘å¸ƒç«¯å’Œè®¢é˜…ç«¯é›†æˆæµ‹è¯•é€šè¿‡
    monitoring_test.go:849:    - A ç«¯æˆåŠŸå‘é€å¥åº·æ£€æŸ¥æ¶ˆæ¯ï¼ˆè‡ªå®šä¹‰é—´éš”ï¼š10ç§’ï¼‰
    monitoring_test.go:850:    - B ç«¯æˆåŠŸæ¥æ”¶ 6 æ¡å¥åº·æ£€æŸ¥æ¶ˆæ¯ï¼ˆæµ‹è¯•æ—¶é•¿ï¼š1åˆ†é’Ÿï¼‰
--- PASS: TestNATSHealthCheckPublisherSubscriberIntegration (63.03s)
FAIL
exit status 1
FAIL	github.com/ChenBigdata421/jxt-core/tests/eventbus/function_tests	332.365s
