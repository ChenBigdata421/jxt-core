=== RUN   TestKafkaVsNATSPerformanceComparison
    kafka_nats_comparison_test.go:208: 🚀 ===== Kafka vs NATS JetStream 全面性能对比测试 =====
    kafka_nats_comparison_test.go:209: 📋 测试要求:
    kafka_nats_comparison_test.go:210:    1. 创建 EventBus 实例（Kafka 和 NATS JetStream）
    kafka_nats_comparison_test.go:211:    2. NATS JetStream 持久化到磁盘
    kafka_nats_comparison_test.go:212:    3. 使用 PublishEnvelope 方法发布
    kafka_nats_comparison_test.go:213:    4. 使用 SubscribeEnvelope 方法订阅
    kafka_nats_comparison_test.go:214:    5. 测试压力：低压500、中压2000、高压5000、极限10000
    kafka_nats_comparison_test.go:215:    6. Topic 数量：5
    kafka_nats_comparison_test.go:216:    7. 统计连接数和消费者组个数
    kafka_nats_comparison_test.go:217:    8. 仅使用 ASCII 字符命名
    kafka_nats_comparison_test.go:218: 
    kafka_nats_comparison_test.go:239: 
        ================================================================================
    kafka_nats_comparison_test.go:240: 🎯 开始 低压 测试 (500 条消息)
    kafka_nats_comparison_test.go:241: ================================================================================
    kafka_nats_comparison_test.go:177: 
        🔄 准备测试环境: 低压
    kafka_nats_comparison_test.go:85: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:121: ⚠️  删除 topic kafka.perf.extreme.topic4 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.extreme.topic2
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.extreme.topic5
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.extreme.topic1
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.extreme.topic3
    kafka_nats_comparison_test.go:126: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:134: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:162:    ✅ 已删除 stream: PERF_extreme_1760270003
    kafka_nats_comparison_test.go:169: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:189: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:247: 
        🔴 测试 Kafka...
2025-10-12T20:00:09.210+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-low-1760270409healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:364: ✅ 已设置预订阅 topic 列表: [kafka.perf.low.topic1 kafka.perf.low.topic2 kafka.perf.low.topic3 kafka.perf.low.topic4 kafka.perf.low.topic5]
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 499/500 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:252: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:257: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T20:00:40.386+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-low-1760270440
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 499/500 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:817: 
        ================================================================================
    kafka_nats_comparison_test.go:818: 📊 低压 测试结果对比
    kafka_nats_comparison_test.go:819: ================================================================================
    kafka_nats_comparison_test.go:822: 
        📨 消息统计:
    kafka_nats_comparison_test.go:823:    发送消息数                | Kafka:      499 | NATS:      499
    kafka_nats_comparison_test.go:824:    接收消息数                | Kafka:      499 | NATS:      998
    kafka_nats_comparison_test.go:825:    成功率                  | Kafka:   99.80% | NATS:  168.80%
    kafka_nats_comparison_test.go:826:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:827:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:828:    顺序违反                 | Kafka:      193 | NATS:      452
    kafka_nats_comparison_test.go:831: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:832:    发送吞吐量                | Kafka:      33.27 msg/s | NATS:      32.21 msg/s
    kafka_nats_comparison_test.go:833:    接收吞吐量                | Kafka:      33.27 msg/s | NATS:      54.48 msg/s
    kafka_nats_comparison_test.go:834:    平均发送延迟               | Kafka:      0.000 ms | NATS:      4.916 ms
    kafka_nats_comparison_test.go:835:    平均处理延迟               | Kafka:      0.016 ms | NATS:      0.007 ms
    kafka_nats_comparison_test.go:836:    总耗时                  | Kafka:      15.00 s | NATS:      15.49 s
    kafka_nats_comparison_test.go:839: 
        💾 资源占用:
    kafka_nats_comparison_test.go:840:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:841:    峰值协程数                | Kafka:      433 | NATS:     5532
    kafka_nats_comparison_test.go:842:    最终协程数                | Kafka:      433 | NATS:     5522
    kafka_nats_comparison_test.go:843:    协程泄漏                 | Kafka:      430 | NATS:     5519
    kafka_nats_comparison_test.go:844:    初始内存                 | Kafka:       1.45 MB | NATS:       1.73 MB
    kafka_nats_comparison_test.go:845:    峰值内存                 | Kafka:       5.63 MB | NATS:      67.32 MB
    kafka_nats_comparison_test.go:846:    最终内存                 | Kafka:       5.81 MB | NATS:      67.01 MB
    kafka_nats_comparison_test.go:847:    内存增量                 | Kafka:       4.35 MB | NATS:      65.28 MB
    kafka_nats_comparison_test.go:850: 
        🔗 连接和消费者组:
    kafka_nats_comparison_test.go:851:    Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:852:    连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:853:    消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:855:    Kafka Topics: [kafka.perf.low.topic1 kafka.perf.low.topic2 kafka.perf.low.topic3 kafka.perf.low.topic4 kafka.perf.low.topic5]
    kafka_nats_comparison_test.go:858:    NATS Topics: [nats.perf.low.1760270440.topic1 nats.perf.low.1760270440.topic2 nats.perf.low.1760270440.topic3 nats.perf.low.1760270440.topic4 nats.perf.low.1760270440.topic5]
    kafka_nats_comparison_test.go:862: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:868:    NATS 吞吐量优势: +63.76%
    kafka_nats_comparison_test.go:876:    NATS 延迟优势: -55.96%
    kafka_nats_comparison_test.go:881:    Kafka 内存优势: -93.33%
    kafka_nats_comparison_test.go:887: ================================================================================
    kafka_nats_comparison_test.go:892: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:892
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 193
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 不应该有顺序违反
    kafka_nats_comparison_test.go:893: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:893
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 452
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:265: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:239: 
        ================================================================================
    kafka_nats_comparison_test.go:240: 🎯 开始 中压 测试 (2000 条消息)
    kafka_nats_comparison_test.go:241: ================================================================================
    kafka_nats_comparison_test.go:177: 
        🔄 准备测试环境: 中压
    kafka_nats_comparison_test.go:85: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:121: ⚠️  删除 topic kafka.perf.low.topic2 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.low.topic3
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.low.topic4
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.low.topic1
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.low.topic5
    kafka_nats_comparison_test.go:126: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:134: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:162:    ✅ 已删除 stream: PERF_low_1760270440
    kafka_nats_comparison_test.go:169: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:189: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:247: 
        🔴 测试 Kafka...
2025-10-12T20:01:10.137+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-medium-1760270470healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:364: ✅ 已设置预订阅 topic 列表: [kafka.perf.medium.topic1 kafka.perf.medium.topic2 kafka.perf.medium.topic3 kafka.perf.medium.topic4 kafka.perf.medium.topic5]
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 1999/2000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:252: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:257: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T20:01:41.363+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-medium-1760270501
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 1999/2000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:817: 
        ================================================================================
    kafka_nats_comparison_test.go:818: 📊 中压 测试结果对比
    kafka_nats_comparison_test.go:819: ================================================================================
    kafka_nats_comparison_test.go:822: 
        📨 消息统计:
    kafka_nats_comparison_test.go:823:    发送消息数                | Kafka:     1999 | NATS:     1999
    kafka_nats_comparison_test.go:824:    接收消息数                | Kafka:     1999 | NATS:     2000
    kafka_nats_comparison_test.go:825:    成功率                  | Kafka:   99.95% | NATS:   90.20%
    kafka_nats_comparison_test.go:826:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:827:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:828:    顺序违反                 | Kafka:      908 | NATS:      925
    kafka_nats_comparison_test.go:831: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:832:    发送吞吐量                | Kafka:     133.20 msg/s | NATS:     131.56 msg/s
    kafka_nats_comparison_test.go:833:    接收吞吐量                | Kafka:     133.20 msg/s | NATS:     118.73 msg/s
    kafka_nats_comparison_test.go:834:    平均发送延迟               | Kafka:      0.058 ms | NATS:      1.921 ms
    kafka_nats_comparison_test.go:835:    平均处理延迟               | Kafka:      0.010 ms | NATS:      0.004 ms
    kafka_nats_comparison_test.go:836:    总耗时                  | Kafka:      15.01 s | NATS:      15.19 s
    kafka_nats_comparison_test.go:839: 
        💾 资源占用:
    kafka_nats_comparison_test.go:840:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:841:    峰值协程数                | Kafka:      433 | NATS:     5545
    kafka_nats_comparison_test.go:842:    最终协程数                | Kafka:      433 | NATS:     5522
    kafka_nats_comparison_test.go:843:    协程泄漏                 | Kafka:      430 | NATS:     5519
    kafka_nats_comparison_test.go:844:    初始内存                 | Kafka:       4.30 MB | NATS:       4.29 MB
    kafka_nats_comparison_test.go:845:    峰值内存                 | Kafka:      12.87 MB | NATS:      67.78 MB
    kafka_nats_comparison_test.go:846:    最终内存                 | Kafka:      10.21 MB | NATS:      67.38 MB
    kafka_nats_comparison_test.go:847:    内存增量                 | Kafka:       5.90 MB | NATS:      63.09 MB
    kafka_nats_comparison_test.go:850: 
        🔗 连接和消费者组:
    kafka_nats_comparison_test.go:851:    Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:852:    连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:853:    消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:855:    Kafka Topics: [kafka.perf.medium.topic1 kafka.perf.medium.topic2 kafka.perf.medium.topic3 kafka.perf.medium.topic4 kafka.perf.medium.topic5]
    kafka_nats_comparison_test.go:858:    NATS Topics: [nats.perf.medium.1760270501.topic1 nats.perf.medium.1760270501.topic2 nats.perf.medium.1760270501.topic3 nats.perf.medium.1760270501.topic4 nats.perf.medium.1760270501.topic5]
    kafka_nats_comparison_test.go:862: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:865:    Kafka 吞吐量优势: +12.19%
    kafka_nats_comparison_test.go:876:    NATS 延迟优势: -61.12%
    kafka_nats_comparison_test.go:881:    Kafka 内存优势: -90.64%
    kafka_nats_comparison_test.go:887: ================================================================================
    kafka_nats_comparison_test.go:892: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:892
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 908
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 不应该有顺序违反
    kafka_nats_comparison_test.go:893: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:893
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 925
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:265: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:239: 
        ================================================================================
    kafka_nats_comparison_test.go:240: 🎯 开始 高压 测试 (5000 条消息)
    kafka_nats_comparison_test.go:241: ================================================================================
    kafka_nats_comparison_test.go:177: 
        🔄 准备测试环境: 高压
    kafka_nats_comparison_test.go:85: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:121: ⚠️  删除 topic kafka.perf.medium.topic5 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.medium.topic3
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.medium.topic1
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.medium.topic2
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.medium.topic4
    kafka_nats_comparison_test.go:126: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:134: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:162:    ✅ 已删除 stream: PERF_medium_1760270501
    kafka_nats_comparison_test.go:169: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:189: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:247: 
        🔴 测试 Kafka...
2025-10-12T20:02:10.679+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-high-1760270530healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:364: ✅ 已设置预订阅 topic 列表: [kafka.perf.high.topic1 kafka.perf.high.topic2 kafka.perf.high.topic3 kafka.perf.high.topic4 kafka.perf.high.topic5]
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 4999/5000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:252: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:257: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T20:02:57.204+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-high-1760270577
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 4999/5000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:817: 
        ================================================================================
    kafka_nats_comparison_test.go:818: 📊 高压 测试结果对比
    kafka_nats_comparison_test.go:819: ================================================================================
    kafka_nats_comparison_test.go:822: 
        📨 消息统计:
    kafka_nats_comparison_test.go:823:    发送消息数                | Kafka:     4999 | NATS:     4999
    kafka_nats_comparison_test.go:824:    接收消息数                | Kafka:     4999 | NATS:     3000
    kafka_nats_comparison_test.go:825:    成功率                  | Kafka:   99.98% | NATS:   60.00%
    kafka_nats_comparison_test.go:826:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:827:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:828:    顺序违反                 | Kafka:     2465 | NATS:     1476
    kafka_nats_comparison_test.go:831: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:832:    发送吞吐量                | Kafka:     166.56 msg/s | NATS:     164.57 msg/s
    kafka_nats_comparison_test.go:833:    接收吞吐量                | Kafka:     166.56 msg/s | NATS:      98.76 msg/s
    kafka_nats_comparison_test.go:834:    平均发送延迟               | Kafka:      0.124 ms | NATS:      3.718 ms
    kafka_nats_comparison_test.go:835:    平均处理延迟               | Kafka:      0.012 ms | NATS:      0.001 ms
    kafka_nats_comparison_test.go:836:    总耗时                  | Kafka:      30.01 s | NATS:      30.38 s
    kafka_nats_comparison_test.go:839: 
        💾 资源占用:
    kafka_nats_comparison_test.go:840:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:841:    峰值协程数                | Kafka:      433 | NATS:     5575
    kafka_nats_comparison_test.go:842:    最终协程数                | Kafka:      433 | NATS:     5522
    kafka_nats_comparison_test.go:843:    协程泄漏                 | Kafka:      430 | NATS:     5519
    kafka_nats_comparison_test.go:844:    初始内存                 | Kafka:       4.62 MB | NATS:       4.63 MB
    kafka_nats_comparison_test.go:845:    峰值内存                 | Kafka:      20.10 MB | NATS:      81.59 MB
    kafka_nats_comparison_test.go:846:    最终内存                 | Kafka:      20.46 MB | NATS:      81.62 MB
    kafka_nats_comparison_test.go:847:    内存增量                 | Kafka:      15.84 MB | NATS:      76.98 MB
    kafka_nats_comparison_test.go:850: 
        🔗 连接和消费者组:
    kafka_nats_comparison_test.go:851:    Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:852:    连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:853:    消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:855:    Kafka Topics: [kafka.perf.high.topic1 kafka.perf.high.topic2 kafka.perf.high.topic3 kafka.perf.high.topic4 kafka.perf.high.topic5]
    kafka_nats_comparison_test.go:858:    NATS Topics: [nats.perf.high.1760270577.topic1 nats.perf.high.1760270577.topic2 nats.perf.high.1760270577.topic3 nats.perf.high.1760270577.topic4 nats.perf.high.1760270577.topic5]
    kafka_nats_comparison_test.go:862: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:865:    Kafka 吞吐量优势: +68.65%
    kafka_nats_comparison_test.go:876:    NATS 延迟优势: -89.39%
    kafka_nats_comparison_test.go:881:    Kafka 内存优势: -79.43%
    kafka_nats_comparison_test.go:887: ================================================================================
    kafka_nats_comparison_test.go:891: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:891
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	"60" is not greater than "90"
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 成功率应该 > 90%
    kafka_nats_comparison_test.go:892: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:892
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 2465
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 不应该有顺序违反
    kafka_nats_comparison_test.go:893: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:893
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 1476
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:265: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:239: 
        ================================================================================
    kafka_nats_comparison_test.go:240: 🎯 开始 极限 测试 (10000 条消息)
    kafka_nats_comparison_test.go:241: ================================================================================
    kafka_nats_comparison_test.go:177: 
        🔄 准备测试环境: 极限
    kafka_nats_comparison_test.go:85: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:121: ⚠️  删除 topic kafka.perf.high.topic1 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.high.topic5
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.high.topic3
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.high.topic4
    kafka_nats_comparison_test.go:123:    ✅ 已删除 topic: kafka.perf.high.topic2
    kafka_nats_comparison_test.go:126: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:134: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:162:    ✅ 已删除 stream: PERF_high_1760270577
    kafka_nats_comparison_test.go:169: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:189: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:247: 
        🔴 测试 Kafka...
2025-10-12T20:03:41.840+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-extreme-1760270621healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:364: ✅ 已设置预订阅 topic 列表: [kafka.perf.extreme.topic1 kafka.perf.extreme.topic2 kafka.perf.extreme.topic3 kafka.perf.extreme.topic4 kafka.perf.extreme.topic5]
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 9999/10000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:252: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:257: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T20:04:27.897+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-extreme-1760270667
    kafka_nats_comparison_test.go:598: ✅ 发送完成: 9999/10000 条消息
    kafka_nats_comparison_test.go:601: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:817: 
        ================================================================================
    kafka_nats_comparison_test.go:818: 📊 极限 测试结果对比
    kafka_nats_comparison_test.go:819: ================================================================================
    kafka_nats_comparison_test.go:822: 
        📨 消息统计:
    kafka_nats_comparison_test.go:823:    发送消息数                | Kafka:     9999 | NATS:     9999
    kafka_nats_comparison_test.go:824:    接收消息数                | Kafka:     9999 | NATS:     3000
    kafka_nats_comparison_test.go:825:    成功率                  | Kafka:   99.99% | NATS:   30.00%
    kafka_nats_comparison_test.go:826:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:827:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:828:    顺序违反                 | Kafka:     4922 | NATS:     1475
    kafka_nats_comparison_test.go:831: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:832:    发送吞吐量                | Kafka:     332.97 msg/s | NATS:     326.71 msg/s
    kafka_nats_comparison_test.go:833:    接收吞吐量                | Kafka:     332.97 msg/s | NATS:      98.02 msg/s
    kafka_nats_comparison_test.go:834:    平均发送延迟               | Kafka:      0.281 ms | NATS:      5.946 ms
    kafka_nats_comparison_test.go:835:    平均处理延迟               | Kafka:      0.015 ms | NATS:      0.003 ms
    kafka_nats_comparison_test.go:836:    总耗时                  | Kafka:      30.03 s | NATS:      30.61 s
    kafka_nats_comparison_test.go:839: 
        💾 资源占用:
    kafka_nats_comparison_test.go:840:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:841:    峰值协程数                | Kafka:      433 | NATS:     5624
    kafka_nats_comparison_test.go:842:    最终协程数                | Kafka:      433 | NATS:     5522
    kafka_nats_comparison_test.go:843:    协程泄漏                 | Kafka:      430 | NATS:     5519
    kafka_nats_comparison_test.go:844:    初始内存                 | Kafka:       4.68 MB | NATS:       4.67 MB
    kafka_nats_comparison_test.go:845:    峰值内存                 | Kafka:      19.90 MB | NATS:      95.35 MB
    kafka_nats_comparison_test.go:846:    最终内存                 | Kafka:      14.98 MB | NATS:      56.74 MB
    kafka_nats_comparison_test.go:847:    内存增量                 | Kafka:      10.30 MB | NATS:      52.07 MB
    kafka_nats_comparison_test.go:850: 
        🔗 连接和消费者组:
    kafka_nats_comparison_test.go:851:    Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:852:    连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:853:    消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:855:    Kafka Topics: [kafka.perf.extreme.topic1 kafka.perf.extreme.topic2 kafka.perf.extreme.topic3 kafka.perf.extreme.topic4 kafka.perf.extreme.topic5]
    kafka_nats_comparison_test.go:858:    NATS Topics: [nats.perf.extreme.1760270667.topic1 nats.perf.extreme.1760270667.topic2 nats.perf.extreme.1760270667.topic3 nats.perf.extreme.1760270667.topic4 nats.perf.extreme.1760270667.topic5]
    kafka_nats_comparison_test.go:862: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:865:    Kafka 吞吐量优势: +239.68%
    kafka_nats_comparison_test.go:876:    NATS 延迟优势: -81.27%
    kafka_nats_comparison_test.go:881:    Kafka 内存优势: -80.22%
    kafka_nats_comparison_test.go:887: ================================================================================
    kafka_nats_comparison_test.go:891: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:891
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	"30" is not greater than "90"
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 成功率应该 > 90%
    kafka_nats_comparison_test.go:892: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:892
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 4922
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 不应该有顺序违反
    kafka_nats_comparison_test.go:893: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:893
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:262
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 1475
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:265: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:898: 
        ====================================================================================================
    kafka_nats_comparison_test.go:899: 🏆 Kafka vs NATS JetStream 综合性能对比报告
    kafka_nats_comparison_test.go:900: ====================================================================================================
    kafka_nats_comparison_test.go:911: 
        📊 性能指标汇总表:
    kafka_nats_comparison_test.go:912: 压力级别       | 系统              | 吞吐量(msg/s)      | 延迟(ms)          | 成功率(%)          | 内存增量(MB)        | 协程泄漏           
    kafka_nats_comparison_test.go:914: ----------------------------------------------------------------------------------------------------
    kafka_nats_comparison_test.go:920: 低压         | Kafka           |           33.27 |           0.016 |           99.80 |            4.35 |             430
    kafka_nats_comparison_test.go:923: 低压         | NATS            |           54.48 |           0.007 |          168.80 |           65.28 |            5519
    kafka_nats_comparison_test.go:926: ----------------------------------------------------------------------------------------------------
    kafka_nats_comparison_test.go:920: 中压         | Kafka           |          133.20 |           0.010 |           99.95 |            5.90 |             430
    kafka_nats_comparison_test.go:923: 中压         | NATS            |          118.73 |           0.004 |           90.20 |           63.09 |            5519
    kafka_nats_comparison_test.go:926: ----------------------------------------------------------------------------------------------------
    kafka_nats_comparison_test.go:920: 高压         | Kafka           |          166.56 |           0.012 |           99.98 |           15.84 |             430
    kafka_nats_comparison_test.go:923: 高压         | NATS            |           98.76 |           0.001 |           60.00 |           76.98 |            5519
    kafka_nats_comparison_test.go:926: ----------------------------------------------------------------------------------------------------
    kafka_nats_comparison_test.go:920: 极限         | Kafka           |          332.97 |           0.015 |           99.99 |           10.30 |             430
    kafka_nats_comparison_test.go:923: 极限         | NATS            |           98.02 |           0.003 |           30.00 |           52.07 |            5519
    kafka_nats_comparison_test.go:926: ----------------------------------------------------------------------------------------------------
    kafka_nats_comparison_test.go:952: 
        🎯 综合评分:
    kafka_nats_comparison_test.go:953: 平均吞吐量                | Kafka:     166.50 msg/s | NATS:      92.50 msg/s
    kafka_nats_comparison_test.go:954: 平均延迟                 | Kafka:      0.013 ms | NATS:      0.004 ms
    kafka_nats_comparison_test.go:955: 平均内存增量               | Kafka:       9.10 MB | NATS:      64.36 MB
    kafka_nats_comparison_test.go:959: 
        🔗 连接和消费者组统计:
    kafka_nats_comparison_test.go:960: Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:961: 连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:962: 消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:966: 
        🏆 最终结论:
    kafka_nats_comparison_test.go:973:    ✅ 吞吐量: Kafka 胜出 (+80.00%)
    kafka_nats_comparison_test.go:987:    ✅ 延迟: NATS 胜出 (-71.76%)
    kafka_nats_comparison_test.go:993:    ✅ 内存效率: Kafka 胜出 (-85.86%)
    kafka_nats_comparison_test.go:1001: 
        🎉 总体获胜者:
    kafka_nats_comparison_test.go:1003:    🥇 Kafka 以 2:1 获胜！
    kafka_nats_comparison_test.go:1011: 
        💡 使用建议:
    kafka_nats_comparison_test.go:1012: 🔴 选择 Kafka 当:
    kafka_nats_comparison_test.go:1013:    • 需要企业级可靠性和持久化保证
    kafka_nats_comparison_test.go:1014:    • 需要复杂的数据处理管道
    kafka_nats_comparison_test.go:1015:    • 需要成熟的生态系统和工具链
    kafka_nats_comparison_test.go:1016:    • 数据量大且需要长期保存
    kafka_nats_comparison_test.go:1018: 
        🔵 选择 NATS JetStream 当:
    kafka_nats_comparison_test.go:1019:    • 需要极致的性能和低延迟
    kafka_nats_comparison_test.go:1020:    • 需要简单的部署和运维
    kafka_nats_comparison_test.go:1021:    • 需要轻量级的消息传递
    kafka_nats_comparison_test.go:1022:    • 构建实时应用和微服务
    kafka_nats_comparison_test.go:1024: 
        ====================================================================================================
    kafka_nats_comparison_test.go:1025: ✅ 测试完成！共执行 4 个场景，8 次测试
    kafka_nats_comparison_test.go:1026: ====================================================================================================
--- FAIL: TestKafkaVsNATSPerformanceComparison (303.57s)
FAIL
exit status 1
FAIL	github.com/ChenBigdata421/jxt-core/tests/eventbus/performance_tests	304.302s
