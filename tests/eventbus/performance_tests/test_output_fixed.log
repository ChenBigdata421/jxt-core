=== RUN   TestKafkaVsNATSPerformanceComparison
    kafka_nats_comparison_test.go:200: 🚀 ===== Kafka vs NATS JetStream 全面性能对比测试 =====
    kafka_nats_comparison_test.go:201: 📋 测试要求:
    kafka_nats_comparison_test.go:202:    1. 创建 EventBus 实例（Kafka 和 NATS JetStream）
    kafka_nats_comparison_test.go:203:    2. NATS JetStream 持久化到磁盘
    kafka_nats_comparison_test.go:204:    3. 使用 PublishEnvelope 方法发布
    kafka_nats_comparison_test.go:205:    4. 使用 SubscribeEnvelope 方法订阅
    kafka_nats_comparison_test.go:206:    5. 测试压力：低压500、中压2000、高压5000、极限10000
    kafka_nats_comparison_test.go:207: 
    kafka_nats_comparison_test.go:228: 
        ================================================================================
    kafka_nats_comparison_test.go:229: 🎯 开始 低压 测试 (500 条消息)
    kafka_nats_comparison_test.go:230: ================================================================================
    kafka_nats_comparison_test.go:169: 
        🔄 准备测试环境: 低压
    kafka_nats_comparison_test.go:77: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:120: ℹ️  没有找到需要清理的 Kafka topics
    kafka_nats_comparison_test.go:126: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:163: ℹ️  没有找到需要清理的 NATS streams
    kafka_nats_comparison_test.go:181: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:236: 
        🔴 测试 Kafka...
2025-10-12T17:37:25.177+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-低压-1760261845healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 499/500 条消息
    kafka_nats_comparison_test.go:526: ⏰ 接收超时: 0/500 条消息
    kafka_nats_comparison_test.go:241: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:246: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T17:38:06.215+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-低压-1760261886
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 499/500 条消息
    kafka_nats_comparison_test.go:522: ✅ 接收完成: 499/500 条消息
    kafka_nats_comparison_test.go:593: 
        ================================================================================
    kafka_nats_comparison_test.go:594: 📊 低压 测试结果对比
    kafka_nats_comparison_test.go:595: ================================================================================
    kafka_nats_comparison_test.go:598: 
        📨 消息统计:
    kafka_nats_comparison_test.go:599:    发送消息数                | Kafka:      499 | NATS:      499
    kafka_nats_comparison_test.go:600:    接收消息数                | Kafka:        0 | NATS:      499
    kafka_nats_comparison_test.go:601:    成功率                  | Kafka:    0.00% | NATS:  100.00%
    kafka_nats_comparison_test.go:602:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:603:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:604:    顺序违反                 | Kafka:        0 | NATS:      184
    kafka_nats_comparison_test.go:607: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:608:    发送吞吐量                | Kafka:      16.09 msg/s | NATS:     234.56 msg/s
    kafka_nats_comparison_test.go:609:    接收吞吐量                | Kafka:       0.00 msg/s | NATS:     234.56 msg/s
    kafka_nats_comparison_test.go:610:    平均发送延迟               | Kafka:      8.057 ms | NATS:      1.126 ms
    kafka_nats_comparison_test.go:611:    平均处理延迟               | Kafka:      0.000 ms | NATS:      0.001 ms
    kafka_nats_comparison_test.go:612:    总耗时                  | Kafka:      31.02 s | NATS:       2.13 s
    kafka_nats_comparison_test.go:615: 
        💾 资源占用:
    kafka_nats_comparison_test.go:616:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:617:    峰值协程数                | Kafka:      131 | NATS:     1424
    kafka_nats_comparison_test.go:618:    最终协程数                | Kafka:      124 | NATS:     1418
    kafka_nats_comparison_test.go:619:    协程泄漏                 | Kafka:      121 | NATS:     1415
    kafka_nats_comparison_test.go:620:    初始内存                 | Kafka:       1.45 MB | NATS:       1.55 MB
    kafka_nats_comparison_test.go:621:    峰值内存                 | Kafka:       3.16 MB | NATS:      20.65 MB
    kafka_nats_comparison_test.go:622:    最终内存                 | Kafka:       2.32 MB | NATS:      20.80 MB
    kafka_nats_comparison_test.go:623:    内存增量                 | Kafka:       1.71 MB | NATS:      19.10 MB
    kafka_nats_comparison_test.go:626: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:632:    NATS 吞吐量优势: ++Inf%
    kafka_nats_comparison_test.go:637:    Kafka 延迟优势: -100.00%
    kafka_nats_comparison_test.go:645:    Kafka 内存优势: -91.06%
    kafka_nats_comparison_test.go:651: ================================================================================
    kafka_nats_comparison_test.go:654: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:654
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:251
        	Error:      	"0" is not greater than "90"
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 成功率应该 > 90%
    kafka_nats_comparison_test.go:657: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:657
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:251
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 184
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:254: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:228: 
        ================================================================================
    kafka_nats_comparison_test.go:229: 🎯 开始 中压 测试 (2000 条消息)
    kafka_nats_comparison_test.go:230: ================================================================================
    kafka_nats_comparison_test.go:169: 
        🔄 准备测试环境: 中压
    kafka_nats_comparison_test.go:77: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:120: ℹ️  没有找到需要清理的 Kafka topics
    kafka_nats_comparison_test.go:126: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:154:    ✅ 已删除 stream: PERF_低压_1760261886
    kafka_nats_comparison_test.go:161: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:181: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:236: 
        🔴 测试 Kafka...
2025-10-12T17:38:20.395+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-中压-1760261900healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 1999/2000 条消息
    kafka_nats_comparison_test.go:526: ⏰ 接收超时: 0/2000 条消息
    kafka_nats_comparison_test.go:241: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:246: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T17:39:31.460+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-中压-1760261971
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 1999/2000 条消息
    kafka_nats_comparison_test.go:522: ✅ 接收完成: 2000/2000 条消息
    kafka_nats_comparison_test.go:593: 
        ================================================================================
    kafka_nats_comparison_test.go:594: 📊 中压 测试结果对比
    kafka_nats_comparison_test.go:595: ================================================================================
    kafka_nats_comparison_test.go:598: 
        📨 消息统计:
    kafka_nats_comparison_test.go:599:    发送消息数                | Kafka:     1999 | NATS:     1999
    kafka_nats_comparison_test.go:600:    接收消息数                | Kafka:        0 | NATS:     2000
    kafka_nats_comparison_test.go:601:    成功率                  | Kafka:    0.00% | NATS:  100.05%
    kafka_nats_comparison_test.go:602:    发送错误                 | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:603:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:604:    顺序违反                 | Kafka:        0 | NATS:      937
    kafka_nats_comparison_test.go:607: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:608:    发送吞吐量                | Kafka:      32.74 msg/s | NATS:     122.95 msg/s
    kafka_nats_comparison_test.go:609:    接收吞吐量                | Kafka:       0.00 msg/s | NATS:     123.01 msg/s
    kafka_nats_comparison_test.go:610:    平均发送延迟               | Kafka:      9.560 ms | NATS:      2.090 ms
    kafka_nats_comparison_test.go:611:    平均处理延迟               | Kafka:      0.000 ms | NATS:      0.002 ms
    kafka_nats_comparison_test.go:612:    总耗时                  | Kafka:      61.05 s | NATS:      16.26 s
    kafka_nats_comparison_test.go:615: 
        💾 资源占用:
    kafka_nats_comparison_test.go:616:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:617:    峰值协程数                | Kafka:      146 | NATS:     1439
    kafka_nats_comparison_test.go:618:    最终协程数                | Kafka:      124 | NATS:     1418
    kafka_nats_comparison_test.go:619:    协程泄漏                 | Kafka:      121 | NATS:     1415
    kafka_nats_comparison_test.go:620:    初始内存                 | Kafka:       2.29 MB | NATS:       2.28 MB
    kafka_nats_comparison_test.go:621:    峰值内存                 | Kafka:       5.08 MB | NATS:      25.49 MB
    kafka_nats_comparison_test.go:622:    最终内存                 | Kafka:       3.23 MB | NATS:      22.73 MB
    kafka_nats_comparison_test.go:623:    内存增量                 | Kafka:       2.80 MB | NATS:      23.20 MB
    kafka_nats_comparison_test.go:626: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:632:    NATS 吞吐量优势: ++Inf%
    kafka_nats_comparison_test.go:637:    Kafka 延迟优势: -100.00%
    kafka_nats_comparison_test.go:645:    Kafka 内存优势: -87.95%
    kafka_nats_comparison_test.go:651: ================================================================================
    kafka_nats_comparison_test.go:654: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:654
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:251
        	Error:      	"0" is not greater than "90"
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 成功率应该 > 90%
    kafka_nats_comparison_test.go:657: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:657
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:251
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 937
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:254: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:228: 
        ================================================================================
    kafka_nats_comparison_test.go:229: 🎯 开始 高压 测试 (5000 条消息)
    kafka_nats_comparison_test.go:230: ================================================================================
    kafka_nats_comparison_test.go:169: 
        🔄 准备测试环境: 高压
    kafka_nats_comparison_test.go:77: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:120: ℹ️  没有找到需要清理的 Kafka topics
    kafka_nats_comparison_test.go:126: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:154:    ✅ 已删除 stream: PERF_中压_1760261971
    kafka_nats_comparison_test.go:161: ✅ 成功删除 1 个 NATS streams
    kafka_nats_comparison_test.go:181: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:236: 
        🔴 测试 Kafka...
2025-10-12T17:39:59.753+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-高压-1760261999healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 4999/5000 条消息
    kafka_nats_comparison_test.go:526: ⏰ 接收超时: 0/5000 条消息
    kafka_nats_comparison_test.go:241: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:246: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-12T17:41:40.883+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-高压-1760262100
    kafka_nats_comparison_test.go:508: ✅ 发送完成: 4999/5000 条消息
