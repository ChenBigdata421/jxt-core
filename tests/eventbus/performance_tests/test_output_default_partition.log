=== RUN   TestKafkaVsNATSPerformanceComparison
    kafka_nats_comparison_test.go:258: 🚀 ===== Kafka vs NATS JetStream 全面性能对比测试 =====
    kafka_nats_comparison_test.go:259: 📋 测试要求:
    kafka_nats_comparison_test.go:260:    1. 创建 EventBus 实例（Kafka 和 NATS JetStream）
    kafka_nats_comparison_test.go:261:    2. NATS JetStream 持久化到磁盘
    kafka_nats_comparison_test.go:262:    3. 使用 PublishEnvelope 方法发布
    kafka_nats_comparison_test.go:263:    4. 使用 SubscribeEnvelope 方法订阅
    kafka_nats_comparison_test.go:264:    5. 测试压力：低压500、中压2000、高压5000、极限10000
    kafka_nats_comparison_test.go:265:    6. Topic 数量：5
    kafka_nats_comparison_test.go:266:    7. 统计连接数和消费者组个数
    kafka_nats_comparison_test.go:267:    8. 仅使用 ASCII 字符命名
    kafka_nats_comparison_test.go:268: 
    kafka_nats_comparison_test.go:289: 
        ================================================================================
    kafka_nats_comparison_test.go:290: 🎯 开始 低压 测试 (500 条消息)
    kafka_nats_comparison_test.go:291: ================================================================================
    kafka_nats_comparison_test.go:227: 
        🔄 准备测试环境: 低压
    kafka_nats_comparison_test.go:135: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:171: ⚠️  删除 topic kafka.perf.low.topic5 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.low.topic2
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.low.topic1
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.low.topic4
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.low.topic3
    kafka_nats_comparison_test.go:176: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:184: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:221: ℹ️  没有找到需要清理的 NATS streams
    kafka_nats_comparison_test.go:239: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:297: 
        🔴 测试 Kafka...
2025-10-13T00:48:44.723+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-low-1760287724healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:414: ✅ 已设置预订阅 topic 列表: [kafka.perf.low.topic1 kafka.perf.low.topic2 kafka.perf.low.topic3 kafka.perf.low.topic4 kafka.perf.low.topic5]
    kafka_nats_comparison_test.go:655: ✅ 发送完成: 500/500 条消息
    kafka_nats_comparison_test.go:658: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:302: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:307: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-13T00:49:16.119+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-low-1760287756
    kafka_nats_comparison_test.go:655: ✅ 发送完成: 500/500 条消息
    kafka_nats_comparison_test.go:658: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:887: 
        ================================================================================
    kafka_nats_comparison_test.go:888: 📊 低压 测试结果对比
    kafka_nats_comparison_test.go:889: ================================================================================
    kafka_nats_comparison_test.go:892: 
        📨 消息统计:
    kafka_nats_comparison_test.go:893:    发送消息数                | Kafka:      500 | NATS:      500
    kafka_nats_comparison_test.go:894:    接收消息数                | Kafka:        0 | NATS:      500
    kafka_nats_comparison_test.go:895:    成功率                  | Kafka:    0.00% | NATS:  100.00%
    kafka_nats_comparison_test.go:896:    发送错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:897:    处理错误                 | Kafka:        0 | NATS:        0
    kafka_nats_comparison_test.go:898:    顺序违反                 | Kafka:        0 | NATS:       28
    kafka_nats_comparison_test.go:901: 
        🚀 性能指标:
    kafka_nats_comparison_test.go:902:    发送吞吐量                | Kafka:      33.33 msg/s | NATS:      33.13 msg/s
    kafka_nats_comparison_test.go:903:    接收吞吐量                | Kafka:       0.00 msg/s | NATS:      33.13 msg/s
    kafka_nats_comparison_test.go:904:    平均发送延迟               | Kafka:      0.140 ms | NATS:      4.481 ms
    kafka_nats_comparison_test.go:905:    平均处理延迟               | Kafka:      0.000 ms | NATS:      0.010 ms
    kafka_nats_comparison_test.go:906:    总耗时                  | Kafka:      15.00 s | NATS:      15.09 s
    kafka_nats_comparison_test.go:909: 
        💾 资源占用:
    kafka_nats_comparison_test.go:910:    初始协程数                | Kafka:        3 | NATS:        3
    kafka_nats_comparison_test.go:911:    峰值协程数                | Kafka:        0 | NATS:     5574
    kafka_nats_comparison_test.go:912:    最终协程数                | Kafka:      369 | NATS:     5517
    kafka_nats_comparison_test.go:913:    协程泄漏                 | Kafka:      366 | NATS:     5514
    kafka_nats_comparison_test.go:914:    初始内存                 | Kafka:       1.46 MB | NATS:       1.73 MB
    kafka_nats_comparison_test.go:915:    峰值内存                 | Kafka:       0.00 MB | NATS:      59.02 MB
    kafka_nats_comparison_test.go:916:    最终内存                 | Kafka:       5.69 MB | NATS:      62.17 MB
    kafka_nats_comparison_test.go:917:    内存增量                 | Kafka:       4.24 MB | NATS:      60.44 MB
    kafka_nats_comparison_test.go:920: 
        🔗 连接和消费者组:
    kafka_nats_comparison_test.go:921:    Topic 数量             | Kafka:        5 | NATS:        5
    kafka_nats_comparison_test.go:922:    连接数                  | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:923:    消费者组个数               | Kafka:        1 | NATS:        1
    kafka_nats_comparison_test.go:925:    Kafka Topics: [kafka.perf.low.topic1 kafka.perf.low.topic2 kafka.perf.low.topic3 kafka.perf.low.topic4 kafka.perf.low.topic5]
    kafka_nats_comparison_test.go:928:    NATS Topics: [nats.perf.low.1760287756.topic1 nats.perf.low.1760287756.topic2 nats.perf.low.1760287756.topic3 nats.perf.low.1760287756.topic4 nats.perf.low.1760287756.topic5]
    kafka_nats_comparison_test.go:932: 
        🏆 性能优势:
    kafka_nats_comparison_test.go:938:    NATS 吞吐量优势: ++Inf%
    kafka_nats_comparison_test.go:943:    Kafka 延迟优势: -100.00%
    kafka_nats_comparison_test.go:951:    Kafka 内存优势: -92.99%
    kafka_nats_comparison_test.go:957: ================================================================================
    kafka_nats_comparison_test.go:960: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:960
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:312
        	Error:      	"0" is not greater than "90"
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	Kafka 成功率应该 > 90%
    kafka_nats_comparison_test.go:963: 
        	Error Trace:	D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:963
        	            				D:/JXT/jxt-evidence-system/jxt-core/tests/eventbus/performance_tests/kafka_nats_comparison_test.go:312
        	Error:      	Not equal: 
        	            	expected: 0
        	            	actual  : 28
        	Test:       	TestKafkaVsNATSPerformanceComparison
        	Messages:   	NATS 不应该有顺序违反
    kafka_nats_comparison_test.go:315: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:289: 
        ================================================================================
    kafka_nats_comparison_test.go:290: 🎯 开始 中压 测试 (2000 条消息)
    kafka_nats_comparison_test.go:291: ================================================================================
    kafka_nats_comparison_test.go:227: 
        🔄 准备测试环境: 中压
    kafka_nats_comparison_test.go:135: 🧹 清理 Kafka 测试数据 (topic prefix: kafka.perf)...
    kafka_nats_comparison_test.go:171: ⚠️  删除 topic kafka.perf.medium.topic5 失败: kafka server: Request was for a topic or partition that does not exist on this broker
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.medium.topic3
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.medium.topic2
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.medium.topic4
    kafka_nats_comparison_test.go:173:    ✅ 已删除 topic: kafka.perf.medium.topic1
    kafka_nats_comparison_test.go:176: ✅ 成功删除 5 个 Kafka topics
    kafka_nats_comparison_test.go:184: 🧹 清理 NATS JetStream 测试数据 (stream prefix: PERF_)...
    kafka_nats_comparison_test.go:221: ℹ️  没有找到需要清理的 NATS streams
    kafka_nats_comparison_test.go:239: ✅ 测试环境准备完成
    kafka_nats_comparison_test.go:297: 
        🔴 测试 Kafka...
2025-10-13T00:49:45.481+0800	INFO	logger/logger.go:48	Kafka EventBus created successfully (AsyncProducer mode)brokers[localhost:29094]clientIdkafka-perf-medium-1760287785healthCheckInterval30scompressionsnappyflushFrequency10msflushMessages100flushBytes1048576
    kafka_nats_comparison_test.go:414: ✅ 已设置预订阅 topic 列表: [kafka.perf.medium.topic1 kafka.perf.medium.topic2 kafka.perf.medium.topic3 kafka.perf.medium.topic4 kafka.perf.medium.topic5]
    kafka_nats_comparison_test.go:655: ✅ 发送完成: 2000/2000 条消息
    kafka_nats_comparison_test.go:658: ⏳ 等待消息处理完成...
    kafka_nats_comparison_test.go:302: ⏳ 等待资源释放...
    kafka_nats_comparison_test.go:307: 
        🔵 测试 NATS JetStream (磁盘持久化)...
2025-10-13T00:50:16.821+0800	INFO	logger/logger.go:48	NATS EventBus created successfullyurls[nats://localhost:4223]clientIdnats-perf-medium-1760287816
    kafka_nats_comparison_test.go:655: ✅ 发送完成: 2000/2000 条消息
    kafka_nats_comparison_test.go:658: ⏳ 等待消息处理完成...
